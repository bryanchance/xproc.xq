<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>XMLSpectrum output</title></head><body><div><pre class="spectrum" style="&#xA;    margin:0px;&#xA;    font-family:'Source Code Pro', monospace;&#xA;    font-size: 0.8em;&#xA;    white-space: pre-wrap;&#xA;    display: block;&#xA;    border: none thin;&#xA;    border-color: #405075;&#xA;    background-color:#002b36;&#xA;    padding: 2px;&#xA;    margin-bottom:5px;&#xA;"><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900"> Copyright Phil Fearon - Qutoric limited 2012 - philipfearon@qutoric.com </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
</span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:transform</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">xmlns:xsl</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">http://www.w3.org/1999/XSL/Transform</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
               </span><span class="atn" style="color: #2aa198">xmlns:xs</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">http://www.w3.org/2001/XMLSchema</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
               </span><span class="atn" style="color: #2aa198">xmlns:loc</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">com.qutoric.sketchpath.functions</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
               </span><span class="atn" style="color: #2aa198">exclude-result-prefixes</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs loc</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">version</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">2.0</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">ops</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">, / = &amp;lt; &amp;gt; + - * ? | != &amp;lt;= &amp;gt;= &amp;lt;&amp;lt; &amp;gt;&amp;gt; //</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">aOps</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">or and eq ne lt le gt ge is to div idiv mod union intersect except in return satisfies then else</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">hOps</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">for some every</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">nodes</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">attribute comment document-node element node processing-instruction text</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">types</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">empty item node schema-attribute schema-element type</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">ambiguousOps</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #cb4b16">tokenize</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="10" select="quick" style="color: #d33682">$aOps</span><span class="op" start="15" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="16" style="color: #93a1a1">\s+</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="21" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">simpleOps</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="20" select="quick" style="color: #cb4b16">tokenize</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="10" select="quick" style="color: #d33682">$ops</span><span class="op" start="14" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="15" style="color: #93a1a1">\s+</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="20" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">nodeTests</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #cb4b16">tokenize</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="10" select="quick" style="color: #d33682">$nodes</span><span class="op" start="16" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="17" style="color: #93a1a1">\s+</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="22" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">typeTests</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="22" select="quick" style="color: #cb4b16">tokenize</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="10" select="quick" style="color: #d33682">$types</span><span class="op" start="16" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="17" style="color: #93a1a1">\s+</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="22" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">higherOps</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #cb4b16">tokenize</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="10" select="quick" style="color: #d33682">$hOps</span><span class="op" start="15" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="16" style="color: #93a1a1">\s+</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="21" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">bgColor</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">black</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:showXPath</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">chunk</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">chars</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="32" select="quick" style="color: #cb4b16">loc:stringToCharSequence</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="26" select="quick" style="color: #d33682">$chunk</span><span class="parenthesis" start="32" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">blocks</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="46" select="quick" style="color: #cb4b16">loc:createBlocks</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="18" select="quick" style="color: #d33682">$chars</span><span class="op" start="24" style="color: #b58900">,</span><span class="whitespace" start="25" style="color: #b58900"> </span><span class="function" start="26" pair-end="32" select="quick" style="color: #cb4b16">false</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="32" style="color: #268bd2">)</span><span class="op" start="33" style="color: #b58900">,</span><span class="whitespace" start="34" style="color: #b58900"> </span><span class="numeric" start="35" style="color: #2aa198">1</span><span class="op" start="36" style="color: #b58900">,</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="38" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="op" start="40" style="color: #b58900">,</span><span class="whitespace" start="41" style="color: #b58900"> </span><span class="numeric" start="42" style="color: #2aa198">0</span><span class="op" start="43" style="color: #b58900">,</span><span class="whitespace" start="44" style="color: #b58900"> </span><span class="numeric" start="45" style="color: #2aa198">0</span><span class="parenthesis" start="46" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">pbPairs</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                  </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="72" select="quick" style="color: #cb4b16">loc:createPairs</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="17" select="quick" style="color: #d33682">$blocks</span><span class="filter" start="24" pair-end="71" select="quick" style="color: #268bd2">[</span><span class="function" start="25" pair-end="30" select="quick" style="color: #cb4b16">name</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="30" style="color: #268bd2">)</span><span class="whitespace" start="31" style="color: #b58900"> </span><span class="op" start="32" style="color: #b58900">=</span><span class="whitespace" start="33" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="34" style="color: #93a1a1">block</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="41" style="color: #b58900"> </span><span class="op" start="42" style="color: #b58900">and</span><span class="whitespace" start="45" style="color: #b58900"> </span><span class="axis" start="46" style="color: #2aa198">@</span><span class="qname" start="47" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="51" style="color: #b58900"> </span><span class="op" start="52" style="color: #b58900">=</span><span class="whitespace" start="53" style="color: #b58900"> </span><span class="parenthesis" start="54" pair-end="70" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="55" style="color: #93a1a1">[</span><span class="op" style="color: #b58900">'</span><span class="op" start="58" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="59" style="color: #93a1a1">]</span><span class="op" style="color: #b58900">'</span><span class="op" start="62" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="63" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="op" start="66" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="67" style="color: #93a1a1">)</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="70" style="color: #268bd2">)</span><span class="filter" start="71" style="color: #268bd2">]</span><span class="parenthesis" start="72" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">omitPairs</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="parenthesis" start="1" pair-end="41" select="quick" style="color: #268bd2">(</span><span class="variable" start="2" select="quick" style="color: #d33682">$blocks</span><span class="filter" start="9" pair-end="40" select="quick" style="color: #268bd2">[</span><span class="function" start="10" pair-end="15" select="quick" style="color: #cb4b16">name</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="15" style="color: #268bd2">)</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" start="17" style="color: #b58900">=</span><span class="whitespace" start="18" style="color: #b58900"> </span><span class="parenthesis" start="19" pair-end="39" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="20" style="color: #93a1a1">literal</span><span class="op" style="color: #b58900">'</span><span class="op" start="29" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="30" style="color: #93a1a1">comment</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="39" style="color: #268bd2">)</span><span class="filter" start="40" style="color: #268bd2">]</span><span class="parenthesis" start="41" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">tokens</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="43" select="quick" style="color: #cb4b16">loc:getTokens</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="15" select="quick" style="color: #d33682">$chunk</span><span class="op" start="21" style="color: #b58900">,</span><span class="whitespace" start="22" style="color: #b58900"> </span><span class="variable" start="23" select="quick" style="color: #d33682">$omitPairs</span><span class="op" start="33" style="color: #b58900">,</span><span class="whitespace" start="34" style="color: #b58900"> </span><span class="variable" start="35" select="quick" style="color: #d33682">$pbPairs</span><span class="parenthesis" start="43" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:call-template</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="tcall" style="color: #6c71c4">plain</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:with-param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">para</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$tokens</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:call-template</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  
  </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900"> //////////////////////////////////////////////////////////////////////////////////////////////// </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900"> 
       Sample output:&#xD;
       &lt;block position="3" type="["/&gt;&#xD;
       &lt;literal type="'" start="54" end="61"/&gt;&#xD;
       &lt;comment start="65" end="69"/&gt;&#xD;
       &lt;comment start="76"/&gt; // if not closed&#xD;
  </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:pad</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">padStringIn</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string?</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">fixedWidth</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">padString</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="33" select="quick" style="color: #cb4b16">replace</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="9" select="quick" style="color: #d33682">$padStringIn</span><span class="op" start="21" style="color: #b58900">,</span><span class="whitespace" start="22" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="23" style="color: #93a1a1">\n</span><span class="op" style="color: #b58900">'</span><span class="op" start="27" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="28" style="color: #93a1a1">\\n</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="33" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">stringLength</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="25" select="quick" style="color: #cb4b16">string-length</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="15" select="quick" style="color: #d33682">$padString</span><span class="parenthesis" start="25" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">padChar</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="22" select="quick" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$fixedWidth</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" start="17" style="color: #b58900">gt</span><span class="whitespace" start="19" style="color: #b58900"> </span><span class="numeric" start="20" style="color: #2aa198">20</span><span class="parenthesis" start="22" style="color: #268bd2">)</span><span class="whitespace" start="23" style="color: #b58900"> </span><span class="op" start="24" style="color: #b58900">then</span><span class="whitespace" start="28" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="29" style="color: #93a1a1">.</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="32" style="color: #b58900"> </span><span class="op" start="33" style="color: #b58900">else</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="38" style="color: #93a1a1"> </span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">padCount</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$fixedWidth</span><span class="whitespace" start="12" style="color: #b58900"> </span><span class="op" start="13" style="color: #b58900">-</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="variable" start="15" select="quick" style="color: #d33682">$stringLength</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$padCount</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">ge</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="numeric" start="14" style="color: #2aa198">0</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75">
          </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="90" select="quick" style="color: #cb4b16">concat</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="8" select="quick" style="color: #d33682">$padString</span><span class="op" start="18" style="color: #b58900">,</span><span class="whitespace" start="19" style="color: #b58900"> </span><span class="function" start="20" pair-end="89" select="quick" style="color: #cb4b16">string-join</span><span class="parenthesis" style="color: #268bd2">(</span><span class="higher" start="32" style="color: #b58900">for</span><span class="whitespace" start="35" style="color: #b58900"> </span><span id="rng-$i" class="variable" start="36" select="quick" style="color: #d33682">$i</span><span class="whitespace" start="38" style="color: #b58900"> </span><span class="op" start="39" style="color: #b58900">in</span><span class="whitespace" start="41" style="color: #b58900"> </span><span class="numeric" start="42" style="color: #2aa198">1</span><span class="whitespace" start="43" style="color: #b58900"> </span><span class="op" start="44" style="color: #b58900">to</span><span class="whitespace" start="46" style="color: #b58900"> </span><span class="variable" start="47" select="quick" style="color: #d33682">$padCount</span><span class="whitespace" start="56" style="color: #b58900"> 
                  </span><span class="op" start="71" style="color: #b58900">return</span><span class="whitespace" start="77" style="color: #b58900"> </span><span class="variable" start="78" select="quick" style="color: #d33682">$padChar</span><span class="op" start="86" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="87" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="89" style="color: #268bd2">)</span><span class="parenthesis" start="90" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$padCount</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">lt</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="numeric" start="14" style="color: #2aa198">0</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75">
          </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="105" select="quick" style="color: #cb4b16">concat</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="8" select="quick" style="color: #d33682">$padString</span><span class="op" start="18" style="color: #b58900">,</span><span class="whitespace" start="19" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="20" style="color: #93a1a1">&amp;#10;</span><span class="op" style="color: #b58900">'</span><span class="op" start="27" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="28" style="color: #93a1a1"> </span><span class="op" style="color: #b58900">'</span><span class="op" start="31" style="color: #b58900">,</span><span class="whitespace" start="32" style="color: #b58900"> </span><span class="function" start="33" pair-end="104" select="quick" style="color: #cb4b16">string-join</span><span class="parenthesis" style="color: #268bd2">(</span><span class="higher" start="45" style="color: #b58900">for</span><span class="whitespace" start="48" style="color: #b58900"> </span><span id="rng-$i" class="variable" start="49" select="quick" style="color: #d33682">$i</span><span class="whitespace" start="51" style="color: #b58900"> </span><span class="op" start="52" style="color: #b58900">in</span><span class="whitespace" start="54" style="color: #b58900"> </span><span class="numeric" start="55" style="color: #2aa198">1</span><span class="whitespace" start="56" style="color: #b58900"> </span><span class="op" start="57" style="color: #b58900">to</span><span class="whitespace" start="59" style="color: #b58900"> </span><span class="variable" start="60" select="quick" style="color: #d33682">$fixedWidth</span><span class="whitespace" start="71" style="color: #b58900"> 
                  </span><span class="op" start="86" style="color: #b58900">return</span><span class="whitespace" start="92" style="color: #b58900"> </span><span class="variable" start="93" select="quick" style="color: #d33682">$padChar</span><span class="op" start="101" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="102" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="104" style="color: #268bd2">)</span><span class="parenthesis" start="105" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:template</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">match</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="qname" start="1" select="quick" style="color: #6c71c4">loc:p</span><span class="filter" start="6" pair-end="24" select="quick" style="color: #268bd2">[</span><span class="axis" start="7" style="color: #2aa198">@</span><span class="qname" start="8" select="quick" style="color: #6c71c4">class</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">eq</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="17" style="color: #93a1a1">dummy</span><span class="op" style="color: #b58900">'</span><span class="filter" start="24" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">test-all</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                  </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="comment" start="1" style="color: #859900">(: comments may be nested
                          (: phil's tokenizer must&#xD;
                          handle quotes also :)&#xD;
                          like this :)</span><span class="whitespace" start="192" style="color: #b58900">
                          </span><span class="context" start="224" style="color: #2aa198">.</span><span class="step" start="225" style="color: #b58900">/</span><span class="qname" start="226" select="quick" style="color: #6c71c4">loc:history</span><span class="step" start="237" style="color: #b58900">/</span><span class="qname" start="238" select="quick" style="color: #6c71c4">loc:*</span><span class="step" start="243" style="color: #b58900">/</span><span class="whitespace" start="244" style="color: #b58900">
                          </span><span class="axis" start="276" style="color: #2aa198">following-sibling::</span><span class="qname" start="295" select="quick" style="color: #6c71c4">loc:books</span><span class="whitespace" start="304" style="color: #b58900">
                          </span><span class="filter" start="336" pair-end="356" select="quick" style="color: #268bd2">[</span><span class="axis" start="337" style="color: #2aa198">@</span><span class="qname" start="338" select="quick" style="color: #6c71c4">id</span><span class="whitespace" start="340" style="color: #b58900"> </span><span class="op" start="341" style="color: #b58900">=</span><span class="whitespace" start="342" style="color: #b58900"> </span><span class="parenthesis" start="343" pair-end="355" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="344" style="color: #93a1a1">a</span><span class="op" style="color: #b58900">'</span><span class="op" start="347" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="348" style="color: #93a1a1">b</span><span class="op" style="color: #b58900">'</span><span class="op" start="351" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="352" style="color: #93a1a1">c</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="355" style="color: #268bd2">)</span><span class="filter" start="356" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$test-all</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:template</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:template</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="tname" style="color: #dc322f">plain</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">para</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">total</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="12" select="quick" style="color: #cb4b16">count</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="7" select="quick" style="color: #d33682">$para</span><span class="parenthesis" start="12" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:for-each</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="numeric" start="1" style="color: #2aa198">1</span><span class="whitespace" start="2" style="color: #b58900"> </span><span class="op" start="3" style="color: #b58900">to</span><span class="whitespace" start="5" style="color: #b58900"> </span><span class="variable" start="6" select="quick" style="color: #d33682">$total</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">index</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="context" start="1" style="color: #2aa198">.</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:for-each</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$para</span><span class="filter" start="6" pair-end="13" select="quick" style="color: #268bd2">[</span><span class="variable" start="7" select="quick" style="color: #d33682">$index</span><span class="filter" start="13" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="en" style="color: #6c71c4">span</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="6" style="color: #b58900"> </span><span class="op" start="7" style="color: #b58900">eq</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="10" style="color: #93a1a1">variable</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="20" style="color: #b58900"> </span><span class="op" start="21" style="color: #b58900">and</span><span class="whitespace" start="24" style="color: #b58900"> </span><span class="variable" start="25" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="31" style="color: #b58900"> </span><span class="op" start="32" style="color: #b58900">+</span><span class="whitespace" start="33" style="color: #b58900"> </span><span class="numeric" start="34" style="color: #2aa198">2</span><span class="whitespace" start="35" style="color: #b58900"> </span><span class="op" start="36" style="color: #b58900">lt</span><span class="whitespace" start="38" style="color: #b58900"> </span><span class="variable" start="39" select="quick" style="color: #d33682">$total</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$para</span><span class="filter" start="6" pair-end="17" select="quick" style="color: #268bd2">[</span><span class="variable" start="7" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">+</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="numeric" start="16" style="color: #2aa198">1</span><span class="filter" start="17" style="color: #268bd2">]</span><span class="step" start="18" style="color: #b58900">/</span><span class="axis" start="19" style="color: #2aa198">@</span><span class="qname" start="20" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="24" style="color: #b58900"> </span><span class="op" start="25" style="color: #b58900">eq</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="28" style="color: #93a1a1">whitespace</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="40" style="color: #b58900"> </span><span class="op" start="41" style="color: #b58900">and</span><span class="whitespace" start="44" style="color: #b58900"> </span><span class="variable" start="45" select="quick" style="color: #d33682">$para</span><span class="filter" start="50" pair-end="61" select="quick" style="color: #268bd2">[</span><span class="variable" start="51" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="57" style="color: #b58900"> </span><span class="op" start="58" style="color: #b58900">+</span><span class="whitespace" start="59" style="color: #b58900"> </span><span class="numeric" start="60" style="color: #2aa198">2</span><span class="filter" start="61" style="color: #268bd2">]</span><span class="step" start="62" style="color: #b58900">/</span><span class="axis" start="63" style="color: #2aa198">@</span><span class="qname" start="64" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="69" style="color: #b58900"> </span><span class="op" start="70" style="color: #b58900">eq</span><span class="whitespace" start="72" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="73" style="color: #93a1a1">in</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">id</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #cb4b16">concat</span><span class="parenthesis" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="8" style="color: #93a1a1">rng-</span><span class="op" style="color: #b58900">'</span><span class="op" start="14" style="color: #b58900">,</span><span class="axis" start="15" style="color: #2aa198">@</span><span class="qname" start="16" select="quick" style="color: #6c71c4">value</span><span class="parenthesis" start="21" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
            </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">className</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="13" select="quick" style="color: #cb4b16">exists</span><span class="parenthesis" style="color: #268bd2">(</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">type</span><span class="parenthesis" start="13" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75">
                    </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="136" select="quick" style="color: #268bd2">(</span><span class="axis" start="5" style="color: #2aa198">@</span><span class="qname" start="6" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">eq</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="14" style="color: #93a1a1">literal</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="23" style="color: #b58900"> </span><span class="op" start="24" style="color: #b58900">and</span><span class="whitespace" start="27" style="color: #b58900">
                               </span><span class="function" start="49" pair-end="116" select="quick" style="color: #cb4b16">matches</span><span class="parenthesis" style="color: #268bd2">(</span><span class="axis" start="57" style="color: #2aa198">@</span><span class="qname" start="58" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="63" style="color: #b58900"> </span><span class="op" start="64" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="65" style="color: #93a1a1">select[\n\p{Zs}]*=[\n\p{Zs}]*[&amp;quot;&amp;apos;&amp;apos;]</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="116" style="color: #268bd2">)</span><span class="whitespace" start="117" style="color: #b58900">
                            </span><span class="parenthesis" start="136" style="color: #268bd2">)</span><span class="whitespace" start="137" style="color: #b58900">
                            </span><span class="op" start="156" style="color: #b58900">then</span><span class="whitespace" start="160" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="161" style="color: #93a1a1">select</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="169" style="color: #b58900"> </span><span class="op" start="170" style="color: #b58900">else</span><span class="whitespace" start="174" style="color: #b58900"> </span><span class="axis" start="175" style="color: #2aa198">@</span><span class="qname" start="176" select="quick" style="color: #6c71c4">type</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
              </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">p</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$para</span><span class="filter" start="6" pair-end="17" select="quick" style="color: #268bd2">[</span><span class="variable" start="7" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">-</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="numeric" start="16" style="color: #2aa198">1</span><span class="filter" start="17" style="color: #268bd2">]</span><span class="whitespace" start="18" style="color: #b58900"> </span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
                </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75">
                    </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="140" select="quick" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$p</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">eq</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="17" style="color: #93a1a1">literal</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="26" style="color: #b58900"> </span><span class="op" start="27" style="color: #b58900">and</span><span class="whitespace" start="30" style="color: #b58900">
                               </span><span class="function" start="52" pair-end="120" select="quick" style="color: #cb4b16">matches</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="60" select="quick" style="color: #d33682">$p</span><span class="step" start="62" style="color: #b58900">/</span><span class="axis" start="63" style="color: #2aa198">@</span><span class="qname" start="64" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="69" style="color: #b58900"> </span><span class="op" start="70" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="71" style="color: #93a1a1">name[\n\p{Zs}]*=[\n\p{Zs}]*[&amp;quot;&amp;apos;&amp;apos;]</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="120" style="color: #268bd2">)</span><span class="whitespace" start="121" style="color: #b58900">
                            </span><span class="parenthesis" start="140" style="color: #268bd2">)</span><span class="whitespace" start="141" style="color: #b58900">
                            </span><span class="op" start="160" style="color: #b58900">then</span><span class="whitespace" start="164" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="165" style="color: #93a1a1">external</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="175" style="color: #b58900">
                            </span><span class="op" start="194" style="color: #b58900">else</span><span class="whitespace" start="198" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="199" style="color: #93a1a1">qname</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
              </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">class</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$className</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$className</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="op" start="12" style="color: #b58900">eq</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="15" style="color: #93a1a1">external</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">id</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #cb4b16">concat</span><span class="parenthesis" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="8" style="color: #93a1a1">ext-</span><span class="op" style="color: #b58900">'</span><span class="op" start="14" style="color: #b58900">,</span><span class="axis" start="15" style="color: #2aa198">@</span><span class="qname" start="16" select="quick" style="color: #6c71c4">value</span><span class="parenthesis" start="21" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="parenthesis" start="1" pair-end="43" select="quick" style="color: #268bd2">(</span><span class="axis" start="2" style="color: #2aa198">@</span><span class="qname" start="3" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="8" style="color: #b58900"> </span><span class="op" start="9" style="color: #b58900">=</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="parenthesis" start="11" pair-end="19" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="12" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="op" start="15" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="16" style="color: #93a1a1">[</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="19" style="color: #268bd2">)</span><span class="whitespace" start="20" style="color: #b58900"> </span><span class="op" start="21" style="color: #b58900">or</span><span class="whitespace" start="23" style="color: #b58900"> </span><span class="axis" start="24" style="color: #2aa198">@</span><span class="qname" start="25" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="29" style="color: #b58900"> </span><span class="op" start="30" style="color: #b58900">eq</span><span class="whitespace" start="32" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="33" style="color: #93a1a1">function</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="43" style="color: #268bd2">)</span><span class="whitespace" start="44" style="color: #b58900"> </span><span class="op" start="45" style="color: #b58900">and</span><span class="whitespace" start="48" style="color: #b58900"> </span><span class="function" start="49" pair-end="62" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="axis" start="53" style="color: #2aa198">@</span><span class="qname" start="54" select="quick" style="color: #6c71c4">pair-end</span><span class="parenthesis" start="62" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">style</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">color: pink;</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">pair-end</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">pair-end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">pair-end</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="10" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="axis" start="5" style="color: #2aa198">@</span><span class="qname" start="6" select="quick" style="color: #6c71c4">type</span><span class="parenthesis" start="10" style="color: #268bd2">)</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="op" start="12" style="color: #b58900">or</span><span class="whitespace" start="14" style="color: #b58900"> 
                            </span><span class="parenthesis" start="36" pair-end="98" select="quick" style="color: #268bd2">(</span><span class="axis" start="37" style="color: #2aa198">@</span><span class="qname" start="38" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="42" style="color: #b58900"> </span><span class="op" start="43" style="color: #b58900">=</span><span class="whitespace" start="44" style="color: #b58900"> </span><span class="parenthesis" start="45" pair-end="97" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="46" style="color: #93a1a1">function</span><span class="op" style="color: #b58900">'</span><span class="op" start="56" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="57" style="color: #93a1a1">filter</span><span class="op" style="color: #b58900">'</span><span class="op" start="65" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="66" style="color: #93a1a1">parenthesis</span><span class="op" style="color: #b58900">'</span><span class="op" start="79" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="80" style="color: #93a1a1">variable</span><span class="op" style="color: #b58900">'</span><span class="op" start="90" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="91" style="color: #93a1a1">node</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="97" style="color: #268bd2">)</span><span class="parenthesis" start="98" style="color: #268bd2">)</span><span class="whitespace" start="99" style="color: #b58900"> 
                               </span><span class="op" start="124" style="color: #b58900">and</span><span class="whitespace" start="127" style="color: #b58900"> </span><span class="parenthesis" start="128" pair-end="152" select="quick" style="color: #268bd2">(</span><span class="function" start="129" pair-end="151" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="axis" start="133" style="color: #2aa198">@</span><span class="qname" start="134" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="139" style="color: #b58900"> </span><span class="op" start="140" style="color: #b58900">=</span><span class="whitespace" start="141" style="color: #b58900"> </span><span class="parenthesis" start="142" pair-end="150" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="143" style="color: #93a1a1">)</span><span class="op" style="color: #b58900">'</span><span class="op" start="146" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="147" style="color: #93a1a1">]</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="150" style="color: #268bd2">)</span><span class="parenthesis" start="151" style="color: #268bd2">)</span><span class="parenthesis" start="152" style="color: #268bd2">)</span><span class="whitespace" start="153" style="color: #b58900">
                             </span><span class="op" start="175" style="color: #b58900">or</span><span class="whitespace" start="177" style="color: #b58900">
                            </span><span class="parenthesis" start="198" pair-end="251" select="quick" style="color: #268bd2">(</span><span class="axis" start="199" style="color: #2aa198">@</span><span class="qname" start="200" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="205" style="color: #b58900"> </span><span class="op" start="206" style="color: #b58900">eq</span><span class="whitespace" start="208" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="209" style="color: #93a1a1">*</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="212" style="color: #b58900"> </span><span class="op" start="213" style="color: #b58900">and</span><span class="whitespace" start="216" style="color: #b58900"> </span><span class="variable" start="217" select="quick" style="color: #d33682">$para</span><span class="filter" start="222" pair-end="233" select="quick" style="color: #268bd2">[</span><span class="variable" start="223" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="229" style="color: #b58900"> </span><span class="op" start="230" style="color: #b58900">-</span><span class="whitespace" start="231" style="color: #b58900"> </span><span class="numeric" start="232" style="color: #2aa198">1</span><span class="filter" start="233" style="color: #268bd2">]</span><span class="step" start="234" style="color: #b58900">/</span><span class="axis" start="235" style="color: #2aa198">@</span><span class="qname" start="236" select="quick" style="color: #6c71c4">class</span><span class="whitespace" start="241" style="color: #b58900"> </span><span class="op" start="242" style="color: #b58900">eq</span><span class="whitespace" start="244" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="245" style="color: #93a1a1">axis</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="251" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">select</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">quick</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="6" style="color: #b58900"> </span><span class="op" start="7" style="color: #b58900">=</span><span class="whitespace" start="8" style="color: #b58900"> </span><span class="parenthesis" start="9" pair-end="29" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="10" style="color: #93a1a1">literal</span><span class="op" style="color: #b58900">'</span><span class="op" start="19" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="20" style="color: #93a1a1">comment</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="29" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:analyze-string</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">value</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">regex</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">\n</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:matching-substring</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                  </span><span class="es" style="color: #586e75">&lt;</span><span class="en" style="color: #6c71c4">br</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
                </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:matching-substring</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:non-matching-substring</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="context" start="1" style="color: #2aa198">.</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
                </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:non-matching-substring</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:analyze-string</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">value</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
            </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="cl" style="color: #6c71c4">span</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:for-each</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:for-each</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:template</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:template</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">match</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="qname" start="1" select="quick" style="color: #6c71c4">token</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">mode</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">plainLine</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="en" style="color: #6c71c4">span</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">class</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">type</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">revChars</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                    </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="37" select="quick" style="color: #cb4b16">reverse</span><span class="parenthesis" style="color: #268bd2">(</span><span class="function" start="9" pair-end="36" select="quick" style="color: #cb4b16">string-to-codepoints</span><span class="parenthesis" style="color: #268bd2">(</span><span class="axis" start="30" style="color: #2aa198">@</span><span class="qname" start="31" select="quick" style="color: #6c71c4">value</span><span class="parenthesis" start="36" style="color: #268bd2">)</span><span class="parenthesis" start="37" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">lastLF</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                    </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="16" select="quick" style="color: #cb4b16">count</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="7" select="quick" style="color: #d33682">$revChars</span><span class="parenthesis" start="16" style="color: #268bd2">)</span><span class="whitespace" start="17" style="color: #b58900"> </span><span class="op" start="18" style="color: #b58900">+</span><span class="whitespace" start="19" style="color: #b58900"> </span><span class="numeric" start="20" style="color: #2aa198">1</span><span class="whitespace" start="21" style="color: #b58900"> </span><span class="op" start="22" style="color: #b58900">-</span><span class="whitespace" start="23" style="color: #b58900"> </span><span class="function" start="24" pair-end="46" select="quick" style="color: #cb4b16">index-of</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="33" select="quick" style="color: #d33682">$revChars</span><span class="op" start="42" style="color: #b58900">,</span><span class="whitespace" start="43" style="color: #b58900"> </span><span class="numeric" start="44" style="color: #2aa198">10</span><span class="parenthesis" start="46" style="color: #268bd2">)</span><span class="filter" start="47" pair-end="49" select="quick" style="color: #268bd2">[</span><span class="numeric" start="48" style="color: #2aa198">1</span><span class="filter" start="49" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="30" select="quick" style="color: #cb4b16">substring</span><span class="parenthesis" style="color: #268bd2">(</span><span class="axis" start="11" style="color: #2aa198">@</span><span class="qname" start="12" select="quick" style="color: #6c71c4">value</span><span class="op" start="17" style="color: #b58900">,</span><span class="whitespace" start="18" style="color: #b58900"> </span><span class="variable" start="19" select="quick" style="color: #d33682">$lastLF</span><span class="whitespace" start="26" style="color: #b58900"> </span><span class="op" start="27" style="color: #b58900">+</span><span class="whitespace" start="28" style="color: #b58900"> </span><span class="numeric" start="29" style="color: #2aa198">1</span><span class="parenthesis" start="30" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="cl" style="color: #6c71c4">span</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:template</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:template</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">match</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="qname" start="1" select="quick" style="color: #6c71c4">token</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">mode</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">dev</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="en" style="color: #6c71c4">p</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="cl" style="color: #6c71c4">p</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:template</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:stringToCharSequence</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">string</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="higher" start="1" style="color: #b58900">for</span><span class="whitespace" start="4" style="color: #b58900"> </span><span id="rng-$i" class="variable" start="5" select="quick" style="color: #d33682">$i</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">in</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="numeric" start="11" style="color: #2aa198">1</span><span class="whitespace" start="12" style="color: #b58900"> </span><span class="op" start="13" style="color: #b58900">to</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="function" start="16" pair-end="37" select="quick" style="color: #cb4b16">string-length</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="30" select="quick" style="color: #d33682">$string</span><span class="parenthesis" start="37" style="color: #268bd2">)</span><span class="whitespace" start="38" style="color: #b58900">
                          </span><span class="op" start="64" style="color: #b58900">return</span><span class="whitespace" start="70" style="color: #b58900"> </span><span class="function" start="71" pair-end="95" select="quick" style="color: #cb4b16">substring</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="81" select="quick" style="color: #d33682">$string</span><span class="op" start="88" style="color: #b58900">,</span><span class="whitespace" start="89" style="color: #b58900"> </span><span class="variable" start="90" select="quick" style="color: #d33682">$i</span><span class="op" start="92" style="color: #b58900">,</span><span class="whitespace" start="93" style="color: #b58900"> </span><span class="numeric" start="94" style="color: #2aa198">1</span><span class="parenthesis" start="95" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:createPairs</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">brackets</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">nested</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:call-template</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="tcall" style="color: #6c71c4">getNesting</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:with-param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">positions</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$brackets</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">tunnel</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">yes</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:with-param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">level</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="numeric" start="1" style="color: #2aa198">0</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:with-param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">index</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="numeric" start="1" style="color: #2aa198">1</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:call-template</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900">  pair up start and end elements </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">ends</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$nested</span><span class="filter" start="8" pair-end="13" select="quick" style="color: #268bd2">[</span><span class="axis" start="9" style="color: #2aa198">@</span><span class="qname" start="10" select="quick" style="color: #6c71c4">end</span><span class="filter" start="13" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:for-each</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$nested</span><span class="filter" start="8" pair-end="15" select="quick" style="color: #268bd2">[</span><span class="axis" start="9" style="color: #2aa198">@</span><span class="qname" start="10" select="quick" style="color: #6c71c4">start</span><span class="filter" start="15" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">level</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="axis" start="1" style="color: #2aa198">@</span><span class="qname" start="2" select="quick" style="color: #6c71c4">level</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">pair</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> 
                    </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="parenthesis" start="1" pair-end="24" select="quick" style="color: #268bd2">(</span><span class="variable" start="2" select="quick" style="color: #d33682">$ends</span><span class="filter" start="7" pair-end="23" select="quick" style="color: #268bd2">[</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">level</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">=</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="variable" start="17" select="quick" style="color: #d33682">$level</span><span class="filter" start="23" style="color: #268bd2">]</span><span class="parenthesis" start="24" style="color: #268bd2">)</span><span class="whitespace" start="25" style="color: #b58900">
                             </span><span class="filter" start="53" pair-end="75" select="quick" style="color: #268bd2">[</span><span class="function" start="54" pair-end="65" select="quick" style="color: #cb4b16">number</span><span class="parenthesis" style="color: #268bd2">(</span><span class="axis" start="61" style="color: #2aa198">@</span><span class="qname" start="62" select="quick" style="color: #6c71c4">end</span><span class="parenthesis" start="65" style="color: #268bd2">)</span><span class="whitespace" start="66" style="color: #b58900"> </span><span class="op" start="67" style="color: #b58900">&gt;</span><span class="whitespace" start="68" style="color: #b58900"> </span><span class="variable" start="69" select="quick" style="color: #d33682">$start</span><span class="filter" start="75" style="color: #268bd2">]</span><span class="filter" start="76" pair-end="78" select="quick" style="color: #268bd2">[</span><span class="numeric" start="77" style="color: #2aa198">1</span><span class="filter" start="78" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                    </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:element</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">{</span><span class="function" start="1" pair-end="20" select="quick" style="color: #cb4b16">concat</span><span class="parenthesis" style="color: #268bd2">(</span><span class="function" start="8" pair-end="14" select="quick" style="color: #cb4b16">name</span><span class="parenthesis" style="color: #268bd2">(</span><span class="context" start="13" style="color: #2aa198">.</span><span class="parenthesis" start="14" style="color: #268bd2">)</span><span class="op" start="15" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="16" style="color: #93a1a1">}}</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="20" style="color: #268bd2">)</span><span class="op" style="color: #b58900">}</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">level</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$level</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pair</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pair</span><span class="step" start="6" style="color: #b58900">/</span><span class="axis" start="7" style="color: #2aa198">@</span><span class="qname" start="8" select="quick" style="color: #6c71c4">end</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:element</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:for-each</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:template</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="tname" style="color: #dc322f">getNesting</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">positions</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">tunnel</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">yes</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">level</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">index</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">pos</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$positions</span><span class="filter" start="11" pair-end="18" select="quick" style="color: #268bd2">[</span><span class="variable" start="12" select="quick" style="color: #d33682">$index</span><span class="filter" start="18" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">isOpen</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pos</span><span class="step" start="5" style="color: #b58900">/</span><span class="axis" start="6" style="color: #2aa198">@</span><span class="qname" start="7" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="op" start="12" style="color: #b58900">=</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="parenthesis" start="14" pair-end="28" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="15" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="op" start="18" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="19" style="color: #93a1a1">[</span><span class="op" style="color: #b58900">'</span><span class="op" start="22" style="color: #b58900">,</span><span class="whitespace" start="23" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="24" style="color: #93a1a1">(:</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="28" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">isBracket</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pos</span><span class="step" start="5" style="color: #b58900">/</span><span class="axis" start="6" style="color: #2aa198">@</span><span class="qname" start="7" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="op" start="12" style="color: #b58900">=</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="parenthesis" start="14" pair-end="22" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="15" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="op" start="18" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="19" style="color: #93a1a1">)</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="22" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">isComment</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pos</span><span class="step" start="5" style="color: #b58900">/</span><span class="axis" start="6" style="color: #2aa198">@</span><span class="qname" start="7" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="op" start="12" style="color: #b58900">=</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="parenthesis" start="14" pair-end="24" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="15" style="color: #93a1a1">(:</span><span class="op" style="color: #b58900">'</span><span class="op" start="19" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="20" style="color: #93a1a1">:)</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="24" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">blockType</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                  </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" pair-end="14" style="color: #b58900">if</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="4" select="quick" style="color: #d33682">$isBracket</span><span class="parenthesis" start="14" style="color: #268bd2">)</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="op" start="16" style="color: #b58900">then</span><span class="whitespace" start="20" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="21" style="color: #93a1a1">bracket</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="30" style="color: #b58900">
                          </span><span class="op" start="56" style="color: #b58900">else</span><span class="whitespace" start="60" style="color: #b58900"> </span><span class="if" start="61" pair-end="74" style="color: #b58900">if</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="64" select="quick" style="color: #d33682">$isComment</span><span class="parenthesis" start="74" style="color: #268bd2">)</span><span class="whitespace" start="75" style="color: #b58900"> </span><span class="op" start="76" style="color: #b58900">then</span><span class="whitespace" start="80" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="81" style="color: #93a1a1">comment</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="90" style="color: #b58900">
                          </span><span class="op" start="116" style="color: #b58900">else</span><span class="whitespace" start="120" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="121" style="color: #93a1a1">predicate</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">newLevel</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                  </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" pair-end="11" style="color: #b58900">if</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="4" select="quick" style="color: #d33682">$isOpen</span><span class="parenthesis" start="11" style="color: #268bd2">)</span><span class="whitespace" start="12" style="color: #b58900">
                          </span><span class="op" start="38" style="color: #b58900">then</span><span class="whitespace" start="42" style="color: #b58900"> </span><span class="variable" start="43" select="quick" style="color: #d33682">$level</span><span class="whitespace" start="49" style="color: #b58900"> </span><span class="op" start="50" style="color: #b58900">+</span><span class="whitespace" start="51" style="color: #b58900"> </span><span class="numeric" start="52" style="color: #2aa198">1</span><span class="whitespace" start="53" style="color: #b58900">
                          </span><span class="op" start="79" style="color: #b58900">else</span><span class="whitespace" start="83" style="color: #b58900"> </span><span class="variable" start="84" select="quick" style="color: #d33682">$level</span><span class="whitespace" start="90" style="color: #b58900"> </span><span class="op" start="91" style="color: #b58900">-</span><span class="whitespace" start="92" style="color: #b58900"> </span><span class="numeric" start="93" style="color: #2aa198">1</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="11" select="quick" style="color: #cb4b16">empty</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="7" select="quick" style="color: #d33682">$pos</span><span class="parenthesis" start="11" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$isOpen</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:element</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">{</span><span class="variable" start="1" select="quick" style="color: #d33682">$blockType</span><span class="op" style="color: #b58900">}</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pos</span><span class="step" start="5" style="color: #b58900">/</span><span class="axis" start="6" style="color: #2aa198">@</span><span class="qname" start="7" select="quick" style="color: #6c71c4">position</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">level</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$newLevel</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:element</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:element</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">{</span><span class="variable" start="1" select="quick" style="color: #d33682">$blockType</span><span class="op" style="color: #b58900">}</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pos</span><span class="step" start="5" style="color: #b58900">/</span><span class="axis" start="6" style="color: #2aa198">@</span><span class="qname" start="7" select="quick" style="color: #6c71c4">position</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">level</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$level</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:element</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">+</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="numeric" start="10" style="color: #2aa198">1</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="op" start="12" style="color: #b58900">&gt;</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="function" start="14" pair-end="30" select="quick" style="color: #cb4b16">count</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="20" select="quick" style="color: #d33682">$positions</span><span class="parenthesis" start="30" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:call-template</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="tcall" style="color: #6c71c4">getNesting</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:with-param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">level</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$newLevel</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:with-param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">index</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">+</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="numeric" start="10" style="color: #2aa198">1</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:call-template</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:template</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:createBlocks</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">chars</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">skip</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">index</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">awaiting</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">level</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">charCount</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="13" select="quick" style="color: #cb4b16">count</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="7" select="quick" style="color: #d33682">$chars</span><span class="parenthesis" start="13" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">char</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$chars</span><span class="filter" start="7" pair-end="14" select="quick" style="color: #268bd2">[</span><span class="variable" start="8" select="quick" style="color: #d33682">$index</span><span class="filter" start="14" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">nChar</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$chars</span><span class="filter" start="7" pair-end="18" select="quick" style="color: #268bd2">[</span><span class="variable" start="8" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">+</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="numeric" start="17" style="color: #2aa198">1</span><span class="filter" start="18" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">pChar</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$chars</span><span class="filter" start="7" pair-end="18" select="quick" style="color: #268bd2">[</span><span class="variable" start="8" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">-</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="numeric" start="17" style="color: #2aa198">1</span><span class="filter" start="18" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">newLevel</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">=</span><span class="whitespace" start="12" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="13" style="color: #93a1a1">:)</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="whitespace" start="1" style="color: #b58900">
                                </span><span class="if" start="30" pair-end="61" style="color: #b58900">if</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="33" select="quick" style="color: #d33682">$char</span><span class="whitespace" start="38" style="color: #b58900"> </span><span class="op" start="39" style="color: #b58900">=</span><span class="whitespace" start="40" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="41" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="44" style="color: #b58900"> </span><span class="op" start="45" style="color: #b58900">and</span><span class="whitespace" start="48" style="color: #b58900"> </span><span class="variable" start="49" select="quick" style="color: #d33682">$nChar</span><span class="whitespace" start="55" style="color: #b58900"> </span><span class="op" start="56" style="color: #b58900">=</span><span class="whitespace" start="57" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="58" style="color: #93a1a1">:</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="61" style="color: #268bd2">)</span><span class="whitespace" start="62" style="color: #b58900"> </span><span class="op" start="63" style="color: #b58900">then</span><span class="whitespace" start="67" style="color: #b58900"> </span><span class="variable" start="68" select="quick" style="color: #d33682">$level</span><span class="whitespace" start="74" style="color: #b58900"> </span><span class="op" start="75" style="color: #b58900">+</span><span class="whitespace" start="76" style="color: #b58900"> </span><span class="numeric" start="77" style="color: #2aa198">1</span><span class="whitespace" start="78" style="color: #b58900">
                                </span><span class="op" start="107" style="color: #b58900">else</span><span class="whitespace" start="111" style="color: #b58900"> </span><span class="if" start="112" style="color: #b58900">if</span><span class="whitespace" start="114" style="color: #b58900"> </span><span class="parenthesis" start="115" pair-end="160" select="quick" style="color: #268bd2">(</span><span class="variable" start="116" select="quick" style="color: #d33682">$char</span><span class="whitespace" start="121" style="color: #b58900"> </span><span class="op" start="122" style="color: #b58900">=</span><span class="whitespace" start="123" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="124" style="color: #93a1a1">)</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="127" style="color: #b58900"> </span><span class="op" start="128" style="color: #b58900">and</span><span class="whitespace" start="131" style="color: #b58900"> </span><span class="variable" start="132" select="quick" style="color: #d33682">$pChar</span><span class="whitespace" start="138" style="color: #b58900"> </span><span class="op" start="139" style="color: #b58900">=</span><span class="whitespace" start="140" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="141" style="color: #93a1a1">:</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="144" style="color: #b58900"> </span><span class="op" start="145" style="color: #b58900">and</span><span class="whitespace" start="148" style="color: #b58900"> </span><span class="variable" start="149" select="quick" style="color: #d33682">$level</span><span class="whitespace" start="155" style="color: #b58900"> </span><span class="op" start="156" style="color: #b58900">gt</span><span class="whitespace" start="158" style="color: #b58900"> </span><span class="numeric" start="159" style="color: #2aa198">0</span><span class="parenthesis" start="160" style="color: #268bd2">)</span><span class="whitespace" start="161" style="color: #b58900"> </span><span class="op" start="162" style="color: #b58900">then</span><span class="whitespace" start="166" style="color: #b58900"> </span><span class="variable" start="167" select="quick" style="color: #d33682">$level</span><span class="whitespace" start="173" style="color: #b58900"> </span><span class="numeric" start="174" style="color: #2aa198">-1</span><span class="whitespace" start="176" style="color: #b58900">
                                </span><span class="op" start="205" style="color: #b58900">else</span><span class="whitespace" start="209" style="color: #b58900"> </span><span class="variable" start="210" select="quick" style="color: #d33682">$level</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$level</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">nowAwaiting</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="op" start="10" style="color: #b58900">=</span><span class="op" style="color: #b58900">'</span><span class="literal" start="11" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75">
              </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" pair-end="37" style="color: #b58900">if</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="4" select="quick" style="color: #d33682">$char</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="op" start="10" style="color: #b58900">=</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="parenthesis" start="12" pair-end="36" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="13" style="color: #93a1a1">&amp;apos;&amp;apos;</span><span class="op" style="color: #b58900">'</span><span class="op" start="27" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="28" style="color: #93a1a1">&amp;quot;</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="36" style="color: #268bd2">)</span><span class="parenthesis" start="37" style="color: #268bd2">)</span><span class="whitespace" start="38" style="color: #b58900">
                       </span><span class="op" start="68" style="color: #b58900">then</span><span class="whitespace" start="72" style="color: #b58900"> </span><span class="variable" start="73" select="quick" style="color: #d33682">$char</span><span class="whitespace" start="78" style="color: #b58900"> 
                      </span><span class="op" start="108" style="color: #b58900">else</span><span class="whitespace" start="112" style="color: #b58900"> </span><span class="if" start="113" style="color: #b58900">if</span><span class="whitespace" start="115" style="color: #b58900"> </span><span class="parenthesis" start="116" pair-end="145" select="quick" style="color: #268bd2">(</span><span class="variable" start="117" select="quick" style="color: #d33682">$char</span><span class="whitespace" start="122" style="color: #b58900"> </span><span class="op" start="123" style="color: #b58900">=</span><span class="whitespace" start="124" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="125" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="128" style="color: #b58900"> </span><span class="op" start="129" style="color: #b58900">and</span><span class="whitespace" start="132" style="color: #b58900"> </span><span class="variable" start="133" select="quick" style="color: #d33682">$nChar</span><span class="whitespace" start="139" style="color: #b58900"> </span><span class="op" start="140" style="color: #b58900">=</span><span class="whitespace" start="141" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="142" style="color: #93a1a1">:</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="145" style="color: #268bd2">)</span><span class="whitespace" start="146" style="color: #b58900"> </span><span class="op" start="147" style="color: #b58900">then</span><span class="whitespace" start="151" style="color: #b58900"> 
                       </span><span class="op" style="color: #b58900">'</span><span class="literal" start="182" style="color: #93a1a1">:)</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="186" style="color: #b58900"> 
                      </span><span class="op" start="216" style="color: #b58900">else</span><span class="whitespace" start="220" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="221" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$char</span><span class="whitespace" start="6" style="color: #b58900"> </span><span class="op" start="7" style="color: #b58900">=</span><span class="whitespace" start="8" style="color: #b58900"> </span><span class="variable" start="9" select="quick" style="color: #d33682">$awaiting</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">=</span><span class="whitespace" start="12" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="13" style="color: #93a1a1">:)</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="17" style="color: #b58900"> </span><span class="op" start="18" style="color: #b58900">and</span><span class="whitespace" start="21" style="color: #b58900"> </span><span class="variable" start="22" select="quick" style="color: #d33682">$char</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="op" start="28" style="color: #b58900">=</span><span class="whitespace" start="29" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="30" style="color: #93a1a1">)</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="33" style="color: #b58900"> </span><span class="op" start="34" style="color: #b58900">and</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="variable" start="38" select="quick" style="color: #d33682">$pChar</span><span class="whitespace" start="44" style="color: #b58900"> </span><span class="op" start="45" style="color: #b58900">=</span><span class="whitespace" start="46" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="47" style="color: #93a1a1">:</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="50" style="color: #b58900"> </span><span class="op" start="51" style="color: #b58900">and</span><span class="whitespace" start="54" style="color: #b58900"> </span><span class="variable" start="55" select="quick" style="color: #d33682">$level</span><span class="whitespace" start="61" style="color: #b58900"> </span><span class="op" start="62" style="color: #b58900">=</span><span class="whitespace" start="63" style="color: #b58900"> </span><span class="numeric" start="64" style="color: #2aa198">0</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">nowSkip</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$skip</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="7" select="quick" style="color: #cb4b16">false</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="7" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$char</span><span class="whitespace" start="6" style="color: #b58900"> </span><span class="op" start="7" style="color: #b58900">=</span><span class="whitespace" start="8" style="color: #b58900"> </span><span class="variable" start="9" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="18" style="color: #b58900"> </span><span class="op" start="19" style="color: #b58900">and</span><span class="whitespace" start="22" style="color: #b58900"> </span><span class="variable" start="23" select="quick" style="color: #d33682">$nChar</span><span class="whitespace" start="29" style="color: #b58900"> </span><span class="op" start="30" style="color: #b58900">=</span><span class="whitespace" start="31" style="color: #b58900"> </span><span class="variable" start="32" select="quick" style="color: #d33682">$char</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="6" select="quick" style="color: #cb4b16">true</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="6" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="7" select="quick" style="color: #cb4b16">false</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="7" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">=</span><span class="whitespace" start="12" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="13" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="op" start="16" style="color: #b58900">and</span><span class="whitespace" start="19" style="color: #b58900"> </span><span class="variable" start="20" select="quick" style="color: #d33682">$nowAwaiting</span><span class="whitespace" start="32" style="color: #b58900"> </span><span class="op" start="33" style="color: #b58900">=</span><span class="whitespace" start="34" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="35" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$char</span><span class="whitespace" start="6" style="color: #b58900"> </span><span class="op" start="7" style="color: #b58900">=</span><span class="whitespace" start="8" style="color: #b58900"> </span><span class="parenthesis" start="9" pair-end="25" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="10" style="color: #93a1a1">[</span><span class="op" style="color: #b58900">'</span><span class="op" start="13" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="14" style="color: #93a1a1">]</span><span class="op" style="color: #b58900">'</span><span class="op" start="17" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="18" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="op" start="21" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="22" style="color: #93a1a1">)</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="25" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="en" style="color: #6c71c4">block</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">position</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">{</span><span class="variable" start="1" select="quick" style="color: #d33682">$index</span><span class="op" style="color: #b58900">}</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">type</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">{</span><span class="variable" start="1" select="quick" style="color: #d33682">$char</span><span class="op" style="color: #b58900">}</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">isFound</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                  </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="29" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">=</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="variable" start="17" select="quick" style="color: #d33682">$nowAwaiting</span><span class="parenthesis" start="29" style="color: #268bd2">)</span><span class="whitespace" start="30" style="color: #b58900"> </span><span class="op" start="31" style="color: #b58900">and</span><span class="whitespace" start="34" style="color: #b58900"> </span><span class="function" start="35" pair-end="56" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="39" select="quick" style="color: #d33682">$skip</span><span class="whitespace" start="44" style="color: #b58900"> </span><span class="op" start="45" style="color: #b58900">or</span><span class="whitespace" start="47" style="color: #b58900"> </span><span class="variable" start="48" select="quick" style="color: #d33682">$nowSkip</span><span class="parenthesis" start="56" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">newStart</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="13" select="quick" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$isFound</span><span class="parenthesis" start="13" style="color: #268bd2">)</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">then</span><span class="whitespace" start="19" style="color: #b58900"> </span><span class="variable" start="20" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="26" style="color: #b58900"> </span><span class="op" start="27" style="color: #b58900">else</span><span class="whitespace" start="31" style="color: #b58900"> </span><span class="variable" start="32" select="quick" style="color: #d33682">$start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">ne</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="14" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" start="17" style="color: #b58900">and</span><span class="whitespace" start="20" style="color: #b58900"> </span><span class="variable" start="21" select="quick" style="color: #d33682">$isFound</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:element</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">{</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="21" select="quick" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">=</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="17" style="color: #93a1a1">:)</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="21" style="color: #268bd2">)</span><span class="whitespace" start="22" style="color: #b58900"> </span><span class="op" start="23" style="color: #b58900">then</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="28" style="color: #93a1a1">comment</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="op" start="38" style="color: #b58900">else</span><span class="whitespace" start="42" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="43" style="color: #93a1a1">literal</span><span class="op" style="color: #b58900">'</span><span class="op" style="color: #b58900">}</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">ne</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="14" style="color: #93a1a1">:)</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$char</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$index</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:element</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">eq</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="variable" start="11" select="quick" style="color: #d33682">$charCount</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">ne</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="14" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" start="17" style="color: #b58900">and</span><span class="whitespace" start="20" style="color: #b58900"> </span><span class="function" start="21" pair-end="33" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="25" select="quick" style="color: #d33682">$isFound</span><span class="parenthesis" start="33" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:element</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">{</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="21" select="quick" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">=</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="17" style="color: #93a1a1">:)</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="21" style="color: #268bd2">)</span><span class="whitespace" start="22" style="color: #b58900"> </span><span class="op" start="23" style="color: #b58900">then</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="28" style="color: #93a1a1">comment</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="op" start="38" style="color: #b58900">else</span><span class="whitespace" start="42" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="43" style="color: #93a1a1">literal</span><span class="op" style="color: #b58900">'</span><span class="op" style="color: #b58900">}</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">ne</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="14" style="color: #93a1a1">:)</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$awaiting</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
            </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:element</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75">
            </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="185" select="quick" style="color: #cb4b16">loc:createBlocks</span><span class="parenthesis" style="color: #268bd2">(</span><span class="whitespace" start="18" style="color: #b58900">
                                      </span><span class="variable" start="53" select="quick" style="color: #d33682">$chars</span><span class="op" start="59" style="color: #b58900">,</span><span class="whitespace" start="60" style="color: #b58900"> </span><span class="variable" start="61" select="quick" style="color: #d33682">$nowSkip</span><span class="op" start="69" style="color: #b58900">,</span><span class="whitespace" start="70" style="color: #b58900"> </span><span class="variable" start="71" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="77" style="color: #b58900"> </span><span class="op" start="78" style="color: #b58900">+</span><span class="whitespace" start="79" style="color: #b58900"> </span><span class="numeric" start="80" style="color: #2aa198">1</span><span class="op" start="81" style="color: #b58900">,</span><span class="whitespace" start="82" style="color: #b58900"> </span><span class="variable" start="83" select="quick" style="color: #d33682">$nowAwaiting</span><span class="op" start="95" style="color: #b58900">,</span><span class="whitespace" start="96" style="color: #b58900">
                                      </span><span class="variable" start="131" select="quick" style="color: #d33682">$newStart</span><span class="op" start="140" style="color: #b58900">,</span><span class="whitespace" start="141" style="color: #b58900"> </span><span class="variable" start="142" select="quick" style="color: #d33682">$newLevel</span><span class="whitespace" start="151" style="color: #b58900">
                                     </span><span class="parenthesis" start="185" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900"> top-level call - marks up tokens with their type </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:getTokens</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">chunk</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">omitPairs</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">pbPairs</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">tokens</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="42" select="quick" style="color: #cb4b16">loc:createTokens</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="18" select="quick" style="color: #d33682">$chunk</span><span class="op" start="24" style="color: #b58900">,</span><span class="whitespace" start="25" style="color: #b58900"> </span><span class="variable" start="26" select="quick" style="color: #d33682">$omitPairs</span><span class="op" start="36" style="color: #b58900">,</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="numeric" start="38" style="color: #2aa198">1</span><span class="op" start="39" style="color: #b58900">,</span><span class="whitespace" start="40" style="color: #b58900"> </span><span class="numeric" start="41" style="color: #2aa198">1</span><span class="parenthesis" start="42" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="70" select="quick" style="color: #cb4b16">loc:rationalizeTokens</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="23" select="quick" style="color: #d33682">$tokens</span><span class="op" start="30" style="color: #b58900">,</span><span class="whitespace" start="31" style="color: #b58900"> </span><span class="numeric" start="32" style="color: #2aa198">1</span><span class="op" start="33" style="color: #b58900">,</span><span class="whitespace" start="34" style="color: #b58900"> </span><span class="function" start="35" pair-end="41" select="quick" style="color: #cb4b16">false</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="41" style="color: #268bd2">)</span><span class="op" start="42" style="color: #b58900">,</span><span class="whitespace" start="43" style="color: #b58900"> </span><span class="variable" start="44" select="quick" style="color: #d33682">$pbPairs</span><span class="op" start="52" style="color: #b58900">,</span><span class="whitespace" start="53" style="color: #b58900"> </span><span class="function" start="54" pair-end="60" select="quick" style="color: #cb4b16">false</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="60" style="color: #268bd2">)</span><span class="op" start="61" style="color: #b58900">,</span><span class="whitespace" start="62" style="color: #b58900"> </span><span class="function" start="63" pair-end="69" select="quick" style="color: #cb4b16">false</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="69" style="color: #268bd2">)</span><span class="parenthesis" start="70" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:rationalizeTokens</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">tokens</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">index</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">prevIsClosed</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">pbPairs</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">typeExpected</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">quantifierExpected</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900"> when closed, a probable operator is a QName instead </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">token</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$tokens</span><span class="filter" start="8" pair-end="15" select="quick" style="color: #268bd2">[</span><span class="variable" start="9" select="quick" style="color: #d33682">$index</span><span class="filter" start="15" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()?</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">isQuantifier</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$quantifierExpected</span><span class="whitespace" start="20" style="color: #b58900"> </span><span class="op" start="21" style="color: #b58900">and</span><span class="whitespace" start="24" style="color: #b58900"> </span><span class="variable" start="25" select="quick" style="color: #d33682">$token</span><span class="step" start="31" style="color: #b58900">/</span><span class="axis" start="32" style="color: #2aa198">@</span><span class="qname" start="33" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="38" style="color: #b58900"> </span><span class="op" start="39" style="color: #b58900">=</span><span class="whitespace" start="40" style="color: #b58900"> </span><span class="parenthesis" start="41" pair-end="53" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="42" style="color: #93a1a1">?</span><span class="op" style="color: #b58900">'</span><span class="op" start="45" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="46" style="color: #93a1a1">*</span><span class="op" style="color: #b58900">'</span><span class="op" start="49" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="50" style="color: #93a1a1">+</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="53" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">currentIsClosed</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                  </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$isQuantifier</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">or</span><span class="whitespace" start="17" style="color: #b58900"> </span><span class="function" start="18" pair-end="34" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="22" select="quick" style="color: #d33682">$token</span><span class="step" start="28" style="color: #b58900">/</span><span class="axis" start="29" style="color: #2aa198">@</span><span class="qname" start="30" select="quick" style="color: #6c71c4">type</span><span class="parenthesis" start="34" style="color: #268bd2">)</span><span class="whitespace" start="35" style="color: #b58900"> </span><span class="op" start="36" style="color: #b58900">or</span><span class="whitespace" start="38" style="color: #b58900"> 
                          </span><span class="parenthesis" start="65" pair-end="170" select="quick" style="color: #268bd2">(</span><span class="variable" start="66" select="quick" style="color: #d33682">$token</span><span class="step" start="72" style="color: #b58900">/</span><span class="axis" start="73" style="color: #2aa198">@</span><span class="qname" start="74" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="79" style="color: #b58900"> </span><span class="op" start="80" style="color: #b58900">=</span><span class="whitespace" start="81" style="color: #b58900"> </span><span class="parenthesis" start="82" pair-end="90" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="83" style="color: #93a1a1">)</span><span class="op" style="color: #b58900">'</span><span class="op" start="86" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="87" style="color: #93a1a1">]</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="90" style="color: #268bd2">)</span><span class="whitespace" start="91" style="color: #b58900"> </span><span class="op" start="92" style="color: #b58900">or</span><span class="whitespace" start="94" style="color: #b58900"> 
                          </span><span class="parenthesis" start="121" pair-end="169" select="quick" style="color: #268bd2">(</span><span class="variable" start="122" select="quick" style="color: #d33682">$token</span><span class="step" start="128" style="color: #b58900">/</span><span class="axis" start="129" style="color: #2aa198">@</span><span class="qname" start="130" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="134" style="color: #b58900"> </span><span class="op" start="135" style="color: #b58900">=</span><span class="whitespace" start="136" style="color: #b58900"> </span><span class="parenthesis" start="137" pair-end="168" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="138" style="color: #93a1a1">literal</span><span class="op" style="color: #b58900">'</span><span class="op" start="147" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="148" style="color: #93a1a1">numeric</span><span class="op" style="color: #b58900">'</span><span class="op" start="157" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="158" style="color: #93a1a1">variable</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="168" style="color: #268bd2">)</span><span class="parenthesis" start="169" style="color: #268bd2">)</span><span class="parenthesis" start="170" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:element</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">token</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">end</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">value</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">value</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">=</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="16" style="color: #93a1a1">probableOp</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$prevIsClosed</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">op</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="18" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$isQuantifier</span><span class="parenthesis" start="18" style="color: #268bd2">)</span><span class="whitespace" start="19" style="color: #b58900"> </span><span class="op" start="20" style="color: #b58900">and</span><span class="whitespace" start="23" style="color: #b58900"> </span><span class="function" start="24" pair-end="41" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="28" select="quick" style="color: #d33682">$prevIsClosed</span><span class="parenthesis" start="41" style="color: #268bd2">)</span><span class="whitespace" start="42" style="color: #b58900"> </span><span class="op" start="43" style="color: #b58900">and</span><span class="whitespace" start="46" style="color: #b58900"> </span><span class="variable" start="47" select="quick" style="color: #d33682">$token</span><span class="step" start="53" style="color: #b58900">/</span><span class="axis" start="54" style="color: #2aa198">@</span><span class="qname" start="55" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="60" style="color: #b58900"> </span><span class="op" start="61" style="color: #b58900">eq</span><span class="whitespace" start="63" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="64" style="color: #93a1a1">*</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900">
               &lt;xsl:attribute name="type" select="'any'"/&gt;&#xD;
          </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">=</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="parenthesis" start="16" pair-end="40" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="17" style="color: #93a1a1">function</span><span class="op" style="color: #b58900">'</span><span class="op" start="27" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="28" style="color: #93a1a1">if</span><span class="op" style="color: #b58900">'</span><span class="op" start="32" style="color: #b58900">,</span><span class="whitespace" start="33" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="34" style="color: #93a1a1">node</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="40" style="color: #268bd2">)</span><span class="whitespace" start="41" style="color: #b58900"> </span><span class="op" start="42" style="color: #b58900">or</span><span class="whitespace" start="44" style="color: #b58900"> </span><span class="variable" start="45" select="quick" style="color: #d33682">$token</span><span class="step" start="51" style="color: #b58900">/</span><span class="axis" start="52" style="color: #2aa198">@</span><span class="qname" start="53" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="58" style="color: #b58900"> </span><span class="op" start="59" style="color: #b58900">=</span><span class="whitespace" start="60" style="color: #b58900"> </span><span class="parenthesis" start="61" pair-end="69" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="62" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="op" start="65" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="66" style="color: #93a1a1">[</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="69" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">pair</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pbPairs</span><span class="filter" start="9" pair-end="30" select="quick" style="color: #268bd2">[</span><span class="axis" start="10" style="color: #2aa198">@</span><span class="qname" start="11" select="quick" style="color: #6c71c4">start</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" start="17" style="color: #b58900">=</span><span class="whitespace" start="18" style="color: #b58900"> </span><span class="variable" start="19" select="quick" style="color: #d33682">$token</span><span class="step" start="25" style="color: #b58900">/</span><span class="axis" start="26" style="color: #2aa198">@</span><span class="qname" start="27" select="quick" style="color: #6c71c4">end</span><span class="filter" start="30" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$typeExpected</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">and</span><span class="whitespace" start="18" style="color: #b58900"> </span><span class="variable" start="19" select="quick" style="color: #d33682">$token</span><span class="step" start="25" style="color: #b58900">/</span><span class="axis" start="26" style="color: #2aa198">@</span><span class="qname" start="27" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="31" style="color: #b58900"> </span><span class="op" start="32" style="color: #b58900">eq</span><span class="whitespace" start="34" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="35" style="color: #93a1a1">node</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">node-type</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
            </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">type</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
            </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="17" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="function" start="5" pair-end="16" select="quick" style="color: #cb4b16">empty</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$pair</span><span class="parenthesis" start="16" style="color: #268bd2">)</span><span class="parenthesis" start="17" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pair</span><span class="step" start="6" style="color: #b58900">/</span><span class="axis" start="7" style="color: #2aa198">@</span><span class="qname" start="8" select="quick" style="color: #6c71c4">end</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">pair-end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pair</span><span class="step" start="6" style="color: #b58900">/</span><span class="axis" start="7" style="color: #2aa198">@</span><span class="qname" start="8" select="quick" style="color: #6c71c4">end</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
            </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">level</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$pair</span><span class="step" start="6" style="color: #b58900">/</span><span class="axis" start="7" style="color: #2aa198">@</span><span class="qname" start="8" select="quick" style="color: #6c71c4">level</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$typeExpected</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="17" select="quick" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$token</span><span class="step" start="11" style="color: #b58900">/</span><span class="axis" start="12" style="color: #2aa198">@</span><span class="qname" start="13" select="quick" style="color: #6c71c4">type</span><span class="parenthesis" start="17" style="color: #268bd2">)</span><span class="whitespace" start="18" style="color: #b58900"> </span><span class="op" start="19" style="color: #b58900">then</span><span class="whitespace" start="23" style="color: #b58900"> </span><span class="variable" start="24" select="quick" style="color: #d33682">$token</span><span class="step" start="30" style="color: #b58900">/</span><span class="axis" start="31" style="color: #2aa198">@</span><span class="qname" start="32" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="36" style="color: #b58900"> </span><span class="op" start="37" style="color: #b58900">else</span><span class="whitespace" start="41" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="42" style="color: #93a1a1">type-name</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$isQuantifier</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">quantifier</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">type</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">type</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:element</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">ignorable</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">=</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="parenthesis" start="16" pair-end="40" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="17" style="color: #93a1a1">whitespace</span><span class="op" style="color: #b58900">'</span><span class="op" start="29" style="color: #b58900">,</span><span class="whitespace" start="30" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="31" style="color: #93a1a1">comment</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="40" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">isNewClosed</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$ignorable</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$prevIsClosed</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="step" start="7" style="color: #b58900">/</span><span class="axis" start="8" style="color: #2aa198">@</span><span class="qname" start="9" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">=</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="16" style="color: #93a1a1">probableOp</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="18" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$prevIsClosed</span><span class="parenthesis" start="18" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$currentIsClosed</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">newTypeExpected</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                  </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="15" select="quick" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$ignorable</span><span class="parenthesis" start="15" style="color: #268bd2">)</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" start="17" style="color: #b58900">then</span><span class="whitespace" start="21" style="color: #b58900"> </span><span class="variable" start="22" select="quick" style="color: #d33682">$typeExpected</span><span class="whitespace" start="35" style="color: #b58900">
                          </span><span class="op" start="53" style="color: #b58900">else</span><span class="whitespace" start="57" style="color: #b58900"> </span><span class="variable" start="58" select="quick" style="color: #d33682">$token</span><span class="step" start="64" style="color: #b58900">/</span><span class="axis" start="65" style="color: #2aa198">@</span><span class="qname" start="66" select="quick" style="color: #6c71c4">type</span><span class="whitespace" start="70" style="color: #b58900"> </span><span class="op" start="71" style="color: #b58900">=</span><span class="whitespace" start="72" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="73" style="color: #93a1a1">type-op</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">+</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="numeric" start="10" style="color: #2aa198">1</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="op" start="12" style="color: #b58900">le</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="function" start="15" pair-end="28" select="quick" style="color: #cb4b16">count</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="21" select="quick" style="color: #d33682">$tokens</span><span class="parenthesis" start="28" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">qExpected</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$typeExpected</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">or</span><span class="whitespace" start="17" style="color: #b58900"> </span><span class="variable" start="18" select="quick" style="color: #d33682">$token</span><span class="step" start="24" style="color: #b58900">/</span><span class="axis" start="25" style="color: #2aa198">@</span><span class="qname" start="26" select="quick" style="color: #6c71c4">value</span><span class="whitespace" start="31" style="color: #b58900"> </span><span class="op" start="32" style="color: #b58900">=</span><span class="whitespace" start="33" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="34" style="color: #93a1a1">)</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      
      
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75">
          </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="114" select="quick" style="color: #cb4b16">loc:rationalizeTokens</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="23" select="quick" style="color: #d33682">$tokens</span><span class="op" start="30" style="color: #b58900">,</span><span class="whitespace" start="31" style="color: #b58900"> </span><span class="variable" start="32" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="38" style="color: #b58900"> </span><span class="op" start="39" style="color: #b58900">+</span><span class="whitespace" start="40" style="color: #b58900"> </span><span class="numeric" start="41" style="color: #2aa198">1</span><span class="op" start="42" style="color: #b58900">,</span><span class="whitespace" start="43" style="color: #b58900"> </span><span class="variable" start="44" select="quick" style="color: #d33682">$isNewClosed</span><span class="op" start="56" style="color: #b58900">,</span><span class="whitespace" start="57" style="color: #b58900">
                  </span><span class="variable" start="76" select="quick" style="color: #d33682">$pbPairs</span><span class="op" start="84" style="color: #b58900">,</span><span class="whitespace" start="85" style="color: #b58900"> </span><span class="variable" start="86" select="quick" style="color: #d33682">$newTypeExpected</span><span class="op" start="102" style="color: #b58900">,</span><span class="whitespace" start="103" style="color: #b58900"> </span><span class="variable" start="104" select="quick" style="color: #d33682">$qExpected</span><span class="parenthesis" start="114" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900"> check tokens like </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:createTokens</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">string</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">excludes</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">index</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">exclude</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()?</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$excludes</span><span class="filter" start="10" pair-end="17" select="quick" style="color: #268bd2">[</span><span class="variable" start="11" select="quick" style="color: #d33682">$index</span><span class="filter" start="17" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer?</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                  </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #268bd2">(</span><span class="function" start="5" pair-end="19" select="quick" style="color: #cb4b16">empty</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$exclude</span><span class="parenthesis" start="19" style="color: #268bd2">)</span><span class="parenthesis" start="20" style="color: #268bd2">)</span><span class="whitespace" start="21" style="color: #b58900">
                             </span><span class="op" start="50" style="color: #b58900">then</span><span class="whitespace" start="54" style="color: #b58900"> </span><span class="parenthesis" start="55" pair-end="56" select="quick" style="color: #268bd2">(</span><span class="parenthesis" start="56" style="color: #268bd2">)</span><span class="whitespace" start="57" style="color: #b58900">
                          </span><span class="op" start="83" style="color: #b58900">else</span><span class="whitespace" start="87" style="color: #b58900"> </span><span class="if" start="88" style="color: #b58900">if</span><span class="whitespace" start="90" style="color: #b58900"> </span><span class="parenthesis" start="91" pair-end="105" select="quick" style="color: #268bd2">(</span><span class="variable" start="92" select="quick" style="color: #d33682">$exclude</span><span class="step" start="100" style="color: #b58900">/</span><span class="axis" start="101" style="color: #2aa198">@</span><span class="qname" start="102" select="quick" style="color: #6c71c4">end</span><span class="parenthesis" start="105" style="color: #268bd2">)</span><span class="whitespace" start="106" style="color: #b58900">
                             </span><span class="op" start="135" style="color: #b58900">then</span><span class="whitespace" start="139" style="color: #b58900">
                             </span><span class="variable" start="168" select="quick" style="color: #d33682">$exclude</span><span class="step" start="176" style="color: #b58900">/</span><span class="axis" start="177" style="color: #2aa198">@</span><span class="qname" start="178" select="quick" style="color: #6c71c4">end</span><span class="whitespace" start="181" style="color: #b58900"> </span><span class="type-op" start="182" style="color: #b58900">cast as</span><span class="whitespace" start="189" style="color: #b58900"> </span><span class="type-name" start="190" style="color: #6c71c4">xs:integer</span><span class="whitespace" start="200" style="color: #b58900"> </span><span class="op" start="201" style="color: #b58900">+</span><span class="whitespace" start="202" style="color: #b58900"> </span><span class="numeric" start="203" style="color: #2aa198">1</span><span class="whitespace" start="204" style="color: #b58900">
                          </span><span class="op" start="230" style="color: #b58900">else</span><span class="whitespace" start="234" style="color: #b58900"> </span><span class="parenthesis" start="235" pair-end="236" select="quick" style="color: #268bd2">(</span><span class="parenthesis" start="236" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">exStart</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer?</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
                  </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="20" select="quick" style="color: #268bd2">(</span><span class="function" start="5" pair-end="19" select="quick" style="color: #cb4b16">empty</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$exclude</span><span class="parenthesis" start="19" style="color: #268bd2">)</span><span class="parenthesis" start="20" style="color: #268bd2">)</span><span class="whitespace" start="21" style="color: #b58900"> </span><span class="op" start="22" style="color: #b58900">then</span><span class="whitespace" start="26" style="color: #b58900"> </span><span class="parenthesis" start="27" pair-end="28" select="quick" style="color: #268bd2">(</span><span class="parenthesis" start="28" style="color: #268bd2">)</span><span class="whitespace" start="29" style="color: #b58900">
                          </span><span class="op" start="47" style="color: #b58900">else</span><span class="whitespace" start="51" style="color: #b58900"> </span><span class="variable" start="52" select="quick" style="color: #d33682">$exclude</span><span class="step" start="60" style="color: #b58900">/</span><span class="axis" start="61" style="color: #2aa198">@</span><span class="qname" start="62" select="quick" style="color: #6c71c4">start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">part</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="15" select="quick" style="color: #cb4b16">empty</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="7" select="quick" style="color: #d33682">$exclude</span><span class="parenthesis" start="15" style="color: #268bd2">)</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="op" start="17" style="color: #b58900">and</span><span class="whitespace" start="20" style="color: #b58900"> </span><span class="variable" start="21" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="op" start="28" style="color: #b58900">=</span><span class="whitespace" start="29" style="color: #b58900"> </span><span class="numeric" start="30" style="color: #2aa198">1</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$string</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="16" select="quick" style="color: #cb4b16">exists</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="8" select="quick" style="color: #d33682">$exStart</span><span class="parenthesis" start="16" style="color: #268bd2">)</span><span class="whitespace" start="17" style="color: #b58900"> </span><span class="op" start="18" style="color: #b58900">and</span><span class="whitespace" start="21" style="color: #b58900"> </span><span class="variable" start="22" select="quick" style="color: #d33682">$exStart</span><span class="whitespace" start="30" style="color: #b58900"> </span><span class="op" start="31" style="color: #b58900">ge</span><span class="whitespace" start="33" style="color: #b58900"> </span><span class="variable" start="34" select="quick" style="color: #d33682">$start</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="45" select="quick" style="color: #cb4b16">substring</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$string</span><span class="op" start="18" style="color: #b58900">,</span><span class="whitespace" start="19" style="color: #b58900"> </span><span class="variable" start="20" select="quick" style="color: #d33682">$start</span><span class="op" start="26" style="color: #b58900">,</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="variable" start="28" select="quick" style="color: #d33682">$exStart</span><span class="whitespace" start="36" style="color: #b58900"> </span><span class="op" start="37" style="color: #b58900">-</span><span class="whitespace" start="38" style="color: #b58900"> </span><span class="variable" start="39" select="quick" style="color: #d33682">$start</span><span class="parenthesis" start="45" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="63" select="quick" style="color: #cb4b16">substring</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$string</span><span class="op" start="18" style="color: #b58900">,</span><span class="whitespace" start="19" style="color: #b58900"> </span><span class="variable" start="20" select="quick" style="color: #d33682">$start</span><span class="op" start="26" style="color: #b58900">,</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="function" start="28" pair-end="49" select="quick" style="color: #cb4b16">string-length</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="42" select="quick" style="color: #d33682">$string</span><span class="parenthesis" start="49" style="color: #268bd2">)</span><span class="whitespace" start="50" style="color: #b58900"> </span><span class="op" start="51" style="color: #b58900">+</span><span class="whitespace" start="52" style="color: #b58900"> </span><span class="numeric" start="53" style="color: #2aa198">1</span><span class="whitespace" start="54" style="color: #b58900"> </span><span class="op" start="55" style="color: #b58900">-</span><span class="whitespace" start="56" style="color: #b58900"> </span><span class="variable" start="57" select="quick" style="color: #d33682">$start</span><span class="parenthesis" start="63" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="20" select="quick" style="color: #cb4b16">string-length</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="15" select="quick" style="color: #d33682">$part</span><span class="parenthesis" start="20" style="color: #268bd2">)</span><span class="whitespace" start="21" style="color: #b58900"> </span><span class="op" start="22" style="color: #b58900">gt</span><span class="whitespace" start="24" style="color: #b58900"> </span><span class="numeric" start="25" style="color: #2aa198">0</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">tokens</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="20" select="quick" style="color: #cb4b16">loc:rawTokens</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="15" select="quick" style="color: #d33682">$part</span><span class="parenthesis" start="20" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      
      </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900"> The XSLT that generates the tokens </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="37" select="quick" style="color: #cb4b16">loc:processTokens</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="19" select="quick" style="color: #d33682">$tokens</span><span class="op" start="26" style="color: #b58900">,</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="variable" start="28" select="quick" style="color: #d33682">$start</span><span class="op" start="34" style="color: #b58900">,</span><span class="whitespace" start="35" style="color: #b58900"> </span><span class="numeric" start="36" style="color: #2aa198">1</span><span class="parenthesis" start="37" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="20" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="function" start="5" pair-end="19" select="quick" style="color: #cb4b16">empty</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$exclude</span><span class="parenthesis" start="19" style="color: #268bd2">)</span><span class="parenthesis" start="20" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:element</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">token</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$exclude</span><span class="step" start="9" style="color: #b58900">/</span><span class="axis" start="10" style="color: #2aa198">@</span><span class="qname" start="11" select="quick" style="color: #6c71c4">start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$exclude</span><span class="step" start="9" style="color: #b58900">/</span><span class="axis" start="10" style="color: #2aa198">@</span><span class="qname" start="11" select="quick" style="color: #6c71c4">end</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$exclude</span><span class="step" start="9" style="color: #b58900">/</span><span class="axis" start="10" style="color: #2aa198">@</span><span class="qname" start="11" select="quick" style="color: #6c71c4">end</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">stringEnd</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="18" select="quick" style="color: #268bd2">(</span><span class="variable" start="5" select="quick" style="color: #d33682">$exclude</span><span class="step" start="13" style="color: #b58900">/</span><span class="axis" start="14" style="color: #2aa198">@</span><span class="qname" start="15" select="quick" style="color: #6c71c4">end</span><span class="parenthesis" start="18" style="color: #268bd2">)</span><span class="whitespace" start="19" style="color: #b58900">
                                </span><span class="op" start="48" style="color: #b58900">then</span><span class="whitespace" start="52" style="color: #b58900"> </span><span class="variable" start="53" select="quick" style="color: #d33682">$exclude</span><span class="step" start="61" style="color: #b58900">/</span><span class="axis" start="62" style="color: #2aa198">@</span><span class="qname" start="63" select="quick" style="color: #6c71c4">end</span><span class="whitespace" start="66" style="color: #b58900">
                                </span><span class="op" start="95" style="color: #b58900">else</span><span class="whitespace" start="99" style="color: #b58900"> </span><span class="function" start="100" pair-end="121" select="quick" style="color: #cb4b16">string-length</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="114" select="quick" style="color: #d33682">$string</span><span class="parenthesis" start="121" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">value</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="107" select="quick" style="color: #cb4b16">substring</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$string</span><span class="op" start="18" style="color: #b58900">,</span><span class="whitespace" start="19" style="color: #b58900">
                                          </span><span class="variable" start="58" select="quick" style="color: #d33682">$exclude</span><span class="step" start="66" style="color: #b58900">/</span><span class="axis" start="67" style="color: #2aa198">@</span><span class="qname" start="68" select="quick" style="color: #6c71c4">start</span><span class="op" start="73" style="color: #b58900">,</span><span class="whitespace" start="74" style="color: #b58900"> </span><span class="variable" start="75" select="quick" style="color: #d33682">$stringEnd</span><span class="whitespace" start="85" style="color: #b58900"> </span><span class="op" start="86" style="color: #b58900">+</span><span class="whitespace" start="87" style="color: #b58900"> </span><span class="numeric" start="88" style="color: #2aa198">1</span><span class="whitespace" start="89" style="color: #b58900"> </span><span class="op" start="90" style="color: #b58900">-</span><span class="whitespace" start="91" style="color: #b58900"> </span><span class="variable" start="92" select="quick" style="color: #d33682">$exclude</span><span class="step" start="100" style="color: #b58900">/</span><span class="axis" start="101" style="color: #2aa198">@</span><span class="qname" start="102" select="quick" style="color: #6c71c4">start</span><span class="parenthesis" start="107" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:attribute</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="14" select="quick" style="color: #cb4b16">name</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="6" select="quick" style="color: #d33682">$exclude</span><span class="parenthesis" start="14" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:element</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900"> iterate 1 pos beyond end of excludes length </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="21" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="function" start="5" pair-end="20" select="quick" style="color: #cb4b16">empty</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$excludes</span><span class="parenthesis" start="20" style="color: #268bd2">)</span><span class="parenthesis" start="21" style="color: #268bd2">)</span><span class="whitespace" start="22" style="color: #b58900"> 
                  </span><span class="op" start="41" style="color: #b58900">and</span><span class="whitespace" start="44" style="color: #b58900"> </span><span class="function" start="45" pair-end="60" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="function" start="49" pair-end="59" select="quick" style="color: #cb4b16">empty</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="55" select="quick" style="color: #d33682">$end</span><span class="parenthesis" start="59" style="color: #268bd2">)</span><span class="parenthesis" start="60" style="color: #268bd2">)</span><span class="whitespace" start="61" style="color: #b58900"> 
                  </span><span class="op" start="80" style="color: #b58900">and</span><span class="whitespace" start="83" style="color: #b58900"> </span><span class="variable" start="84" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="90" style="color: #b58900"> </span><span class="op" start="91" style="color: #b58900">le</span><span class="whitespace" start="93" style="color: #b58900"> </span><span class="function" start="94" pair-end="109" select="quick" style="color: #cb4b16">count</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="100" select="quick" style="color: #d33682">$excludes</span><span class="parenthesis" start="109" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="54" select="quick" style="color: #cb4b16">loc:createTokens</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="18" select="quick" style="color: #d33682">$string</span><span class="op" start="25" style="color: #b58900">,</span><span class="whitespace" start="26" style="color: #b58900"> </span><span class="variable" start="27" select="quick" style="color: #d33682">$excludes</span><span class="op" start="36" style="color: #b58900">,</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="variable" start="38" select="quick" style="color: #d33682">$end</span><span class="op" start="42" style="color: #b58900">,</span><span class="whitespace" start="43" style="color: #b58900"> </span><span class="variable" start="44" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="50" style="color: #b58900"> </span><span class="op" start="51" style="color: #b58900">+</span><span class="whitespace" start="52" style="color: #b58900"> </span><span class="numeric" start="53" style="color: #2aa198">1</span><span class="parenthesis" start="54" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:processTokens</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">element()*</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">tokens</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">index</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">token</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string?</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$tokens</span><span class="filter" start="8" pair-end="15" select="quick" style="color: #268bd2">[</span><span class="variable" start="9" select="quick" style="color: #d33682">$index</span><span class="filter" start="15" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$start</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">+</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="function" start="10" pair-end="30" select="quick" style="color: #cb4b16">string-length</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="24" select="quick" style="color: #d33682">$token</span><span class="parenthesis" start="30" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:element</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">token</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">start</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$start</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">end</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$end</span><span class="whitespace" start="5" style="color: #b58900"> </span><span class="op" start="6" style="color: #b58900">-</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="numeric" start="8" style="color: #2aa198">1</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">value</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">isSimpleOps</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">=</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="variable" start="10" select="quick" style="color: #d33682">$simpleOps</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$isSimpleOps</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" pair-end="23" style="color: #b58900">if</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="4" select="quick" style="color: #d33682">$token</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" start="11" style="color: #b58900">=</span><span class="whitespace" start="12" style="color: #b58900"> </span><span class="parenthesis" start="13" pair-end="22" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="14" style="color: #93a1a1">/</span><span class="op" style="color: #b58900">'</span><span class="op" start="17" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="18" style="color: #93a1a1">//</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="22" style="color: #268bd2">)</span><span class="parenthesis" start="23" style="color: #268bd2">)</span><span class="whitespace" start="24" style="color: #b58900"> </span><span class="op" start="25" style="color: #b58900">then</span><span class="whitespace" start="29" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="30" style="color: #93a1a1">step</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="36" style="color: #b58900"> </span><span class="op" start="37" style="color: #b58900">else</span><span class="whitespace" start="41" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="42" style="color: #93a1a1">op</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">isDoubleToken</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:boolean</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$isSimpleOps</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="7" select="quick" style="color: #cb4b16">false</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="7" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">splitToken</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="31" select="quick" style="color: #cb4b16">tokenize</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="10" select="quick" style="color: #d33682">$token</span><span class="op" start="16" style="color: #b58900">,</span><span class="whitespace" start="17" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="18" style="color: #93a1a1">[\n\p{Zs}]+</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="31" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75">
                </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" style="color: #b58900">if</span><span class="whitespace" start="3" style="color: #b58900"> </span><span class="parenthesis" start="4" pair-end="28" select="quick" style="color: #268bd2">(</span><span class="function" start="5" pair-end="22" select="quick" style="color: #cb4b16">count</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$splitToken</span><span class="parenthesis" start="22" style="color: #268bd2">)</span><span class="whitespace" start="23" style="color: #b58900"> </span><span class="op" start="24" style="color: #b58900">ne</span><span class="whitespace" start="26" style="color: #b58900"> </span><span class="numeric" start="27" style="color: #2aa198">2</span><span class="parenthesis" start="28" style="color: #268bd2">)</span><span class="whitespace" start="29" style="color: #b58900"> 
                         </span><span class="op" start="48" style="color: #b58900">then</span><span class="whitespace" start="52" style="color: #b58900"> </span><span class="function" start="53" pair-end="59" select="quick" style="color: #cb4b16">false</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="59" style="color: #268bd2">)</span><span class="whitespace" start="60" style="color: #b58900">
                        </span><span class="op" start="77" style="color: #b58900">else</span><span class="whitespace" start="81" style="color: #b58900"> </span><span class="if" start="82" style="color: #b58900">if</span><span class="whitespace" start="84" style="color: #b58900"> </span><span class="parenthesis" start="85" pair-end="141" select="quick" style="color: #268bd2">(</span><span class="variable" start="86" select="quick" style="color: #d33682">$splitToken</span><span class="filter" start="97" pair-end="99" select="quick" style="color: #268bd2">[</span><span class="numeric" start="98" style="color: #2aa198">1</span><span class="filter" start="99" style="color: #268bd2">]</span><span class="whitespace" start="100" style="color: #b58900"> </span><span class="op" start="101" style="color: #b58900">eq</span><span class="whitespace" start="103" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="104" style="color: #93a1a1">instance</span><span class="op" style="color: #b58900">'</span><span class="whitespace" start="114" style="color: #b58900"> </span><span class="op" start="115" style="color: #b58900">and</span><span class="whitespace" start="118" style="color: #b58900"> </span><span class="variable" start="119" select="quick" style="color: #d33682">$splitToken</span><span class="filter" start="130" pair-end="132" select="quick" style="color: #268bd2">[</span><span class="numeric" start="131" style="color: #2aa198">2</span><span class="filter" start="132" style="color: #268bd2">]</span><span class="whitespace" start="133" style="color: #b58900"> </span><span class="op" start="134" style="color: #b58900">eq</span><span class="whitespace" start="136" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="137" style="color: #93a1a1">of</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="141" style="color: #268bd2">)</span><span class="whitespace" start="142" style="color: #b58900"> 
                         </span><span class="op" start="161" style="color: #b58900">then</span><span class="whitespace" start="165" style="color: #b58900"> </span><span class="function" start="166" pair-end="171" select="quick" style="color: #cb4b16">true</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="171" style="color: #268bd2">)</span><span class="whitespace" start="172" style="color: #b58900">
                        </span><span class="op" start="189" style="color: #b58900">else</span><span class="whitespace" start="193" style="color: #b58900"> </span><span class="if" start="194" style="color: #b58900">if</span><span class="whitespace" start="196" style="color: #b58900"> </span><span class="parenthesis" start="197" pair-end="269" select="quick" style="color: #268bd2">(</span><span class="variable" start="198" select="quick" style="color: #d33682">$splitToken</span><span class="filter" start="209" pair-end="211" select="quick" style="color: #268bd2">[</span><span class="numeric" start="210" style="color: #2aa198">1</span><span class="filter" start="211" style="color: #268bd2">]</span><span class="whitespace" start="212" style="color: #b58900"> </span><span class="op" start="213" style="color: #b58900">=</span><span class="whitespace" start="214" style="color: #b58900"> </span><span class="parenthesis" start="215" pair-end="241" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="216" style="color: #93a1a1">cast</span><span class="op" style="color: #b58900">'</span><span class="op" start="222" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="223" style="color: #93a1a1">castable</span><span class="op" style="color: #b58900">'</span><span class="op" start="233" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="234" style="color: #93a1a1">treat</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="241" style="color: #268bd2">)</span><span class="whitespace" start="242" style="color: #b58900"> </span><span class="op" start="243" style="color: #b58900">and</span><span class="whitespace" start="246" style="color: #b58900"> </span><span class="variable" start="247" select="quick" style="color: #d33682">$splitToken</span><span class="filter" start="258" pair-end="260" select="quick" style="color: #268bd2">[</span><span class="numeric" start="259" style="color: #2aa198">2</span><span class="filter" start="260" style="color: #268bd2">]</span><span class="whitespace" start="261" style="color: #b58900"> </span><span class="op" start="262" style="color: #b58900">eq</span><span class="whitespace" start="264" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="265" style="color: #93a1a1">as</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="269" style="color: #268bd2">)</span><span class="whitespace" start="270" style="color: #b58900">
                         </span><span class="op" start="288" style="color: #b58900">then</span><span class="whitespace" start="292" style="color: #b58900"> </span><span class="function" start="293" pair-end="298" select="quick" style="color: #cb4b16">true</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="298" style="color: #268bd2">)</span><span class="whitespace" start="299" style="color: #b58900"> </span><span class="op" start="300" style="color: #b58900">else</span><span class="whitespace" start="304" style="color: #b58900"> </span><span class="function" start="305" pair-end="311" select="quick" style="color: #cb4b16">false</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="311" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$isDoubleToken</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">type-op</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">functionType</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75">
              </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$isSimpleOps</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">or</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="variable" start="17" select="quick" style="color: #d33682">$isDoubleToken</span><span class="whitespace" start="31" style="color: #b58900"> </span><span class="op" start="32" style="color: #b58900">or</span><span class="whitespace" start="34" style="color: #b58900"> </span><span class="function" start="35" pair-end="55" select="quick" style="color: #cb4b16">string-length</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="49" select="quick" style="color: #d33682">$token</span><span class="parenthesis" start="55" style="color: #268bd2">)</span><span class="whitespace" start="56" style="color: #b58900"> </span><span class="op" start="57" style="color: #b58900">=</span><span class="whitespace" start="58" style="color: #b58900"> </span><span class="numeric" start="59" style="color: #2aa198">1</span><span class="whitespace" start="60" style="color: #b58900"> </span><span class="op" start="61" style="color: #b58900">or</span><span class="whitespace" start="63" style="color: #b58900"> </span><span class="function" start="64" pair-end="89" select="quick" style="color: #cb4b16">not</span><span class="parenthesis" style="color: #268bd2">(</span><span class="function" start="68" pair-end="88" select="quick" style="color: #cb4b16">ends-with</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="78" select="quick" style="color: #d33682">$token</span><span class="op" start="84" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="85" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="88" style="color: #268bd2">)</span><span class="parenthesis" start="89" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:text</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:variable</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">fnName</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="34" select="quick" style="color: #cb4b16">tokenize</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="10" select="quick" style="color: #d33682">$token</span><span class="op" start="16" style="color: #b58900">,</span><span class="whitespace" start="17" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="18" style="color: #93a1a1">[\n\p{Zs}]+|\(</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="34" style="color: #268bd2">)</span><span class="filter" start="35" pair-end="37" select="quick" style="color: #268bd2">[</span><span class="numeric" start="36" style="color: #2aa198">1</span><span class="filter" start="37" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$fnName</span><span class="whitespace" start="8" style="color: #b58900"> </span><span class="op" start="9" style="color: #b58900">=</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="11" style="color: #93a1a1">if</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:text</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">if</span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:text</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="higher" start="1" style="color: #b58900">some</span><span class="whitespace" start="5" style="color: #b58900"> </span><span id="rng-$n" class="variable" start="6" select="quick" style="color: #d33682">$n</span><span class="whitespace" start="8" style="color: #b58900"> </span><span class="op" start="9" style="color: #b58900">in</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="variable" start="12" select="quick" style="color: #d33682">$nodeTests</span><span class="whitespace" start="22" style="color: #b58900"> </span><span class="op" start="23" style="color: #b58900">satisfies</span><span class="whitespace" start="32" style="color: #b58900"> </span><span class="variable" start="33" select="quick" style="color: #d33682">$n</span><span class="whitespace" start="35" style="color: #b58900"> </span><span class="op" start="36" style="color: #b58900">=</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="variable" start="38" select="quick" style="color: #d33682">$fnName</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:text</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">node</span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:text</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="higher" start="1" style="color: #b58900">some</span><span class="whitespace" start="5" style="color: #b58900"> </span><span id="rng-$x" class="variable" start="6" select="quick" style="color: #d33682">$x</span><span class="whitespace" start="8" style="color: #b58900"> </span><span class="op" start="9" style="color: #b58900">in</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="variable" start="12" select="quick" style="color: #d33682">$typeTests</span><span class="whitespace" start="22" style="color: #b58900"> </span><span class="op" start="23" style="color: #b58900">satisfies</span><span class="whitespace" start="32" style="color: #b58900"> </span><span class="variable" start="33" select="quick" style="color: #d33682">$x</span><span class="whitespace" start="35" style="color: #b58900"> </span><span class="op" start="36" style="color: #b58900">=</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="variable" start="38" select="quick" style="color: #d33682">$fnName</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:text</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">type</span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:text</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
                </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:text</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">function</span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:text</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
              </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:otherwise</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:variable</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$isSimpleOps</span><span class="whitespace" start="13" style="color: #b58900"> </span><span class="op" start="14" style="color: #b58900">or</span><span class="whitespace" start="16" style="color: #b58900"> </span><span class="variable" start="17" select="quick" style="color: #d33682">$isDoubleToken</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$functionType</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="op" start="15" style="color: #b58900">ne</span><span class="whitespace" start="17" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="18" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$functionType</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="23" select="quick" style="color: #cb4b16">ends-with</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="11" select="quick" style="color: #d33682">$token</span><span class="op" start="17" style="color: #b58900">,</span><span class="whitespace" start="18" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="19" style="color: #93a1a1">::</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="23" style="color: #268bd2">)</span><span class="whitespace" start="24" style="color: #b58900"> </span><span class="op" start="25" style="color: #b58900">or</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="variable" start="28" select="quick" style="color: #d33682">$token</span><span class="whitespace" start="34" style="color: #b58900"> </span><span class="op" start="35" style="color: #b58900">eq</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="38" style="color: #93a1a1">@</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">axis</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="29" select="quick" style="color: #cb4b16">matches</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="9" select="quick" style="color: #d33682">$token</span><span class="op" start="15" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="16" style="color: #93a1a1">[\n\p{Zs}]+</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="29" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">whitespace</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">=</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="parenthesis" start="10" pair-end="19" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="11" style="color: #93a1a1">.</span><span class="op" style="color: #b58900">'</span><span class="op" start="14" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="15" style="color: #93a1a1">..</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="19" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">context</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">=</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="parenthesis" start="10" pair-end="18" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="11" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="op" start="14" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="15" style="color: #93a1a1">)</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="18" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">parenthesis</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">=</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="parenthesis" start="10" pair-end="18" select="quick" style="color: #268bd2">(</span><span class="op" style="color: #b58900">'</span><span class="literal" start="11" style="color: #93a1a1">[</span><span class="op" style="color: #b58900">'</span><span class="op" start="14" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="15" style="color: #93a1a1">]</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="18" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">filter</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="14" select="quick" style="color: #cb4b16">number</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="8" select="quick" style="color: #d33682">$token</span><span class="parenthesis" start="14" style="color: #268bd2">)</span><span class="whitespace" start="15" style="color: #b58900"> </span><span class="op" start="16" style="color: #b58900">=</span><span class="whitespace" start="17" style="color: #b58900"> </span><span class="function" start="18" pair-end="31" select="quick" style="color: #cb4b16">number</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="25" select="quick" style="color: #d33682">$token</span><span class="parenthesis" start="31" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">numeric</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">=</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="variable" start="10" select="quick" style="color: #d33682">$ambiguousOps</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">probableOp</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">=</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="variable" start="10" select="quick" style="color: #d33682">$higherOps</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="51" select="quick" style="color: #cb4b16">starts-with</span><span class="parenthesis" style="color: #268bd2">(</span><span class="function" start="13" pair-end="45" select="quick" style="color: #cb4b16">loc:nextNonWhite</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="30" select="quick" style="color: #d33682">$tokens</span><span class="op" start="37" style="color: #b58900">,</span><span class="whitespace" start="38" style="color: #b58900"> </span><span class="variable" start="39" select="quick" style="color: #d33682">$index</span><span class="parenthesis" start="45" style="color: #268bd2">)</span><span class="op" start="46" style="color: #b58900">,</span><span class="whitespace" start="47" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="48" style="color: #93a1a1">$</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="51" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">higher</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$token</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">eq</span><span class="whitespace" start="10" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="11" style="color: #93a1a1">if</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="33" select="quick" style="color: #cb4b16">loc:nextNonWhite</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="18" select="quick" style="color: #d33682">$tokens</span><span class="op" start="25" style="color: #b58900">,</span><span class="whitespace" start="26" style="color: #b58900"> </span><span class="variable" start="27" select="quick" style="color: #d33682">$index</span><span class="parenthesis" start="33" style="color: #268bd2">)</span><span class="whitespace" start="34" style="color: #b58900"> </span><span class="op" start="35" style="color: #b58900">eq</span><span class="whitespace" start="37" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="38" style="color: #93a1a1">(</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
            </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">if</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
          </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="24" select="quick" style="color: #cb4b16">starts-with</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="13" select="quick" style="color: #d33682">$token</span><span class="op" start="19" style="color: #b58900">,</span><span class="whitespace" start="20" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="21" style="color: #93a1a1">$</span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="24" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
          </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:attribute</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">type</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="op" style="color: #b58900">'</span><span class="literal" start="1" style="color: #93a1a1">variable</span><span class="op" style="color: #b58900">'</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
        </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:element</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:if</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="7" style="color: #b58900"> </span><span class="op" start="8" style="color: #b58900">+</span><span class="whitespace" start="9" style="color: #b58900"> </span><span class="numeric" start="10" style="color: #2aa198">1</span><span class="whitespace" start="11" style="color: #b58900"> </span><span class="op" start="12" style="color: #b58900">le</span><span class="whitespace" start="14" style="color: #b58900"> </span><span class="function" start="15" pair-end="28" select="quick" style="color: #cb4b16">count</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="21" select="quick" style="color: #d33682">$tokens</span><span class="parenthesis" start="28" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:sequence</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="44" select="quick" style="color: #cb4b16">loc:processTokens</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="19" select="quick" style="color: #d33682">$tokens</span><span class="op" start="26" style="color: #b58900">,</span><span class="whitespace" start="27" style="color: #b58900"> </span><span class="variable" start="28" select="quick" style="color: #d33682">$end</span><span class="op" start="32" style="color: #b58900">,</span><span class="whitespace" start="33" style="color: #b58900"> </span><span class="variable" start="34" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="40" style="color: #b58900"> </span><span class="op" start="41" style="color: #b58900">+</span><span class="whitespace" start="42" style="color: #b58900"> </span><span class="numeric" start="43" style="color: #2aa198">1</span><span class="parenthesis" start="44" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:if</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:nextNonWhite</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string?</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">tokens</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">index</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:integer</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:choose</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:when</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">test</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="6" select="quick" style="color: #cb4b16">true</span><span class="parenthesis" style="color: #268bd2">(</span><span class="parenthesis" start="6" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="z" style="color: #586e75">&lt;!--</span><span class="cm" style="color: #859900"> test="$index + 2 lt count($tokens)"&gt;  </span><span class="z" style="color: #586e75">--&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75">
            </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="if" start="1" pair-end="55" style="color: #b58900">if</span><span class="parenthesis" style="color: #268bd2">(</span><span class="function" start="4" pair-end="48" select="quick" style="color: #cb4b16">replace</span><span class="parenthesis" style="color: #268bd2">(</span><span class="variable" start="12" select="quick" style="color: #d33682">$tokens</span><span class="filter" start="19" pair-end="30" select="quick" style="color: #268bd2">[</span><span class="variable" start="20" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="26" style="color: #b58900"> </span><span class="op" start="27" style="color: #b58900">+</span><span class="whitespace" start="28" style="color: #b58900"> </span><span class="numeric" start="29" style="color: #2aa198">1</span><span class="filter" start="30" style="color: #268bd2">]</span><span class="op" start="31" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="32" style="color: #93a1a1">[\n\p{Zs}]+</span><span class="op" style="color: #b58900">'</span><span class="op" start="45" style="color: #b58900">,</span><span class="op" style="color: #b58900">'</span><span class="literal" start="46" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="48" style="color: #268bd2">)</span><span class="whitespace" start="49" style="color: #b58900"> </span><span class="op" start="50" style="color: #b58900">eq</span><span class="whitespace" start="52" style="color: #b58900"> </span><span class="op" style="color: #b58900">'</span><span class="literal" start="53" style="color: #93a1a1"></span><span class="op" style="color: #b58900">'</span><span class="parenthesis" start="55" style="color: #268bd2">)</span><span class="whitespace" start="56" style="color: #b58900">
                       </span><span class="op" start="78" style="color: #b58900">then</span><span class="whitespace" start="82" style="color: #b58900"> </span><span class="variable" start="83" select="quick" style="color: #d33682">$tokens</span><span class="filter" start="90" pair-end="101" select="quick" style="color: #268bd2">[</span><span class="variable" start="91" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="97" style="color: #b58900"> </span><span class="op" start="98" style="color: #b58900">+</span><span class="whitespace" start="99" style="color: #b58900"> </span><span class="numeric" start="100" style="color: #2aa198">2</span><span class="filter" start="101" style="color: #268bd2">]</span><span class="whitespace" start="102" style="color: #b58900">
                       </span><span class="op" start="124" style="color: #b58900">else</span><span class="whitespace" start="128" style="color: #b58900"> </span><span class="variable" start="129" select="quick" style="color: #d33682">$tokens</span><span class="filter" start="136" pair-end="147" select="quick" style="color: #268bd2">[</span><span class="variable" start="137" select="quick" style="color: #d33682">$index</span><span class="whitespace" start="143" style="color: #b58900"> </span><span class="op" start="144" style="color: #b58900">+</span><span class="whitespace" start="145" style="color: #b58900"> </span><span class="numeric" start="146" style="color: #2aa198">1</span><span class="filter" start="147" style="color: #268bd2">]</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:when</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:otherwise</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:choose</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
  </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:function</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="fname" style="color: #dc322f">loc:rawTokens</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string*</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:param</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">name</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="vname" style="color: #d33682">chunk</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">as</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">xs:string</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
    </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:analyze-string</span><span class="z" style="color: #586e75">
        </span><span class="atn" style="color: #2aa198">regex</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="av" style="color: #859900">(((-)?\d+)(\.)?(\d+([eE][\+\-]?)?\d*)?)|(\?)|(instance[\n\p{{Zs}}]+of)|(cast[\n\p{{Zs}}]+as)|(castable[\n\p{{Zs}}]+as)|(treat[\n\p{{Zs}}]+as)|((\$[\n\p{{Zs}}]*)?[\i\*][\p{{L}}\p{{Nd}}\.\-]*(:[\p{{L}}\p{{Nd}}\.\-\*]*)?(::)?:?)(\()?|(\.\.)|((-)?\d?\.\d*)|-|([&amp;lt;&amp;gt;!]=)|(&amp;gt;&amp;gt;|&amp;lt;&amp;lt;)|(//)|([\n\p{{Zs}}]+)|(\C)</span><span class="z" style="color: #586e75">"</span><span class="z" style="color: #586e75">
        </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="variable" start="1" select="quick" style="color: #d33682">$chunk</span><span class="z" style="color: #586e75">"</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
      </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:matching-substring</span><span class="scx" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
        </span><span class="es" style="color: #586e75">&lt;</span><span class="enxsl" style="color: #268bd2">xsl:value-of</span><span class="z" style="color: #586e75"> </span><span class="atn" style="color: #2aa198">select</span><span class="atneq" style="color: #586e75">=</span><span class="z" style="color: #586e75">"</span><span class="function" start="1" pair-end="9" select="quick" style="color: #cb4b16">string</span><span class="parenthesis" style="color: #268bd2">(</span><span class="context" start="8" style="color: #2aa198">.</span><span class="parenthesis" start="9" style="color: #268bd2">)</span><span class="z" style="color: #586e75">"</span><span class="sc" style="color: #586e75">/&gt;</span><span class="txt" style="color: #839496">
      </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:matching-substring</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
    </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:analyze-string</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  </span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:function</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
  
</span><span class="ez" style="color: #586e75">&lt;/</span><span class="clxsl" style="color: #268bd2">xsl:transform</span><span class="ec" style="color: #586e75">&gt;</span><span class="txt" style="color: #839496">
</span></pre></div></body></html>